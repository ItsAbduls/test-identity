2023-07-15 19:52:39.671 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-15 19:52:39.750 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-15 19:52:39.754 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-15 19:52:39.758 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-15 19:52:39.761 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-15 19:52:39.765 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-15 19:52:39.768 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-15 19:52:39.791 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-15 19:52:39.802 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-15 19:52:39.806 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-15 19:52:39.823 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-15 19:52:39.833 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-15 19:52:39.870 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-15 19:52:39.879 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-15 19:52:56.405 +04:00 [DBG] Login Url: /Account/Login
2023-07-15 19:52:56.410 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-15 19:52:56.412 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-15 19:52:56.416 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-15 19:52:56.419 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-15 19:52:56.422 +04:00 [DBG] Error Url: /home/error
2023-07-15 19:52:56.425 +04:00 [DBG] Error Id Parameter: errorId
2023-07-15 19:52:57.958 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:52:57.994 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:52:57.997 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:52:58.005 +04:00 [DBG] Start authorize request
2023-07-15 19:52:58.039 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:52:58.073 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:53:00.700 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:53:00.707 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:53:00.710 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:53:00.719 +04:00 [DBG] Start authorize request
2023-07-15 19:53:00.726 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:53:00.744 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:53:01.611 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:53:01.627 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:53:01.632 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:53:01.640 +04:00 [DBG] Start authorize request
2023-07-15 19:53:01.651 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:53:01.669 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:53:01.987 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:53:01.989 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:53:01.995 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:53:02.099 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:53:02.105 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:53:02.105 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:53:02.140 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:53:02.144 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:53:02.148 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:53:02.512 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:53:02.645 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:53:02.645 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:53:02.645 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:53:02.776 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:53:02.925 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:53:02.928 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:53:02.946 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:53:02.983 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:53:03.040 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:53:03.043 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:53:03.045 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:53:03.109 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:53:03.114 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:53:03.117 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:53:03.194 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"8ad8b72b768a460bbd3b3fdc6682cb16","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"8ad8b72b768a460bbd3b3fdc6682cb16","code_challenge":"dKojl0lkdUh0ov7h5f3QnlhFnWcNc9LB80cq2HVEhgU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:53:03.194 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5e9629d026d545e0b28b08189e9e37bb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5e9629d026d545e0b28b08189e9e37bb","code_challenge":"koAWF92jPNTFXhgZqkG2VTSxfGGiG5Cf8iA1cFBY0Gg","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:53:03.194 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e793c7b2710b4ca89574664345beaf12","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"e793c7b2710b4ca89574664345beaf12","code_challenge":"IqjHEkNAZ51_IfSISzxr7mjCmukW2ohFpxfzwF-ie2I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:53:03.315 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:53:03.317 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:53:03.339 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:53:03.341 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:53:03.344 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:53:03.349 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:53:03.353 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:53:03.365 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:53:03.372 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 19:53:03.389 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 19:53:03.393 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:53:03.397 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 19:53:03.403 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5e9629d026d545e0b28b08189e9e37bb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5e9629d026d545e0b28b08189e9e37bb","code_challenge":"koAWF92jPNTFXhgZqkG2VTSxfGGiG5Cf8iA1cFBY0Gg","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:53:04.200 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:53:04.276 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:53:04.282 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:53:04.288 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:53:04.304 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:53:04.316 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:53:04.327 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:53:04.331 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:53:58.374 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:53:58.439 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:53:58.450 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:53:58.453 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:53:58.463 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:53:58.471 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:53:58.479 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:53:58.482 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:54:21.687 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:54:21.807 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:54:21.809 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:54:21.812 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:54:21.824 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:54:21.845 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:54:21.857 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:54:21.859 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:54:21.968 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 19:54:21.971 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 19:54:21.974 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 19:54:21.986 +04:00 [DBG] Start authorize callback request
2023-07-15 19:54:21.995 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:54:21.998 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:54:22.048 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:54:22.050 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:54:22.053 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:54:22.063 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:54:22.107 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:54:22.122 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:54:22.124 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:54:22.131 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e793c7b2710b4ca89574664345beaf12","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"e793c7b2710b4ca89574664345beaf12","code_challenge":"IqjHEkNAZ51_IfSISzxr7mjCmukW2ohFpxfzwF-ie2I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:54:22.149 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:54:22.152 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:54:22.156 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:54:22.164 +04:00 [INF] Error: User denied consent to required scopes
2023-07-15 19:54:22.167 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e793c7b2710b4ca89574664345beaf12","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"e793c7b2710b4ca89574664345beaf12","code_challenge":"IqjHEkNAZ51_IfSISzxr7mjCmukW2ohFpxfzwF-ie2I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:54:23.809 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:54:23.855 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:54:23.858 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:54:23.870 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:54:23.878 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:54:23.881 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:54:23.890 +04:00 [DBG] Start discovery request
2023-07-15 19:54:23.965 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:54:24.175 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:54:24.248 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-15 19:54:24.271 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:54:24.390 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:54:24.396 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:54:24.402 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:54:24.419 +04:00 [DBG] Start authorize request
2023-07-15 19:54:24.426 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:54:24.438 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:54:24.508 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:54:24.514 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:54:24.517 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:54:24.528 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:54:24.539 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:54:24.554 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:54:24.559 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:54:24.562 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"54ffe66b9dc843f29535705d76e3d904","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"54ffe66b9dc843f29535705d76e3d904","code_challenge":"lTxMqLut_OfmiNheAugU8ngh7VMPCf89ccWQBq3rW3Q","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:54:24.592 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:54:24.595 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:54:24.599 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:54:24.666 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 19:54:24.698 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"54ffe66b9dc843f29535705d76e3d904","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"54ffe66b9dc843f29535705d76e3d904","code_challenge":"lTxMqLut_OfmiNheAugU8ngh7VMPCf89ccWQBq3rW3Q","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:09.471 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:55:09.475 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:55:09.478 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:55:09.484 +04:00 [DBG] Start authorize request
2023-07-15 19:55:09.488 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:55:09.492 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:55:09.622 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:09.625 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:09.629 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:55:09.645 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:09.675 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:09.691 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:09.695 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:55:09.700 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"78f660a08e9a4abd85f21b3905ef5154","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"78f660a08e9a4abd85f21b3905ef5154","code_challenge":"SZgAuJRs8jZdLjXIQHKuG4Z9F7LjoqS_CKgzUbta1-8","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:09.719 +04:00 [DBG] Client is configured to not require consent, no consent is required
2023-07-15 19:55:09.733 +04:00 [DBG] Creating Authorization Code Flow response.
2023-07-15 19:55:09.957 +04:00 [DBG] c08VAiKMMTIKt4YjuGOzwrblB2KV9VwzR5+RuyngVVI= not found in database
2023-07-15 19:55:10.514 +04:00 [DBG] Authorize endpoint response
{"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ClientId":"insig_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"78f660a08e9a4abd85f21b3905ef5154","Scope":"openid profile email insigapi.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2023-07-15 19:55:10.533 +04:00 [DBG] Augmenting SignInContext
2023-07-15 19:55:12.016 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:55:12.031 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:12.074 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:12.098 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:55:12.103 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:55:12.107 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:55:12.110 +04:00 [DBG] Start discovery request
2023-07-15 19:55:12.163 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:55:12.206 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:55:12.216 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:12.223 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:12.234 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:55:12.239 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:55:12.244 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:55:12.248 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:55:12.253 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:55:12.256 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:55:12.260 +04:00 [DBG] Start discovery request
2023-07-15 19:55:12.266 +04:00 [DBG] Start authorize request
2023-07-15 19:55:12.273 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:55:12.277 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:55:12.453 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:55:12.512 +04:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:4200
2023-07-15 19:55:12.518 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:12.537 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:12.556 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2023-07-15 19:55:12.665 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:12.678 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:12.682 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2023-07-15 19:55:12.687 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2023-07-15 19:55:12.691 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:55:12.703 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:12.715 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:12.726 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:12.729 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:55:12.736 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"3c4cf1570ea24a5bbb26811afe0c8c05","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"959C1D985B489DFA133AC3C78871417D","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"3c4cf1570ea24a5bbb26811afe0c8c05","code_challenge":"XkZfCHpmRCkm-yx4oThTNruxl8qcZ9HAaRobS-mK4W8","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:12.739 +04:00 [DBG] Start token request.
2023-07-15 19:55:12.754 +04:00 [DBG] Client is configured to not require consent, no consent is required
2023-07-15 19:55:12.759 +04:00 [DBG] Creating Authorization Code Flow response.
2023-07-15 19:55:12.812 +04:00 [DBG] N8S3cuVRca0j98BhT4fWwhBvBARyycN+6mIUeZ7XxFI= not found in database
2023-07-15 19:55:12.815 +04:00 [DBG] Start client validation
2023-07-15 19:55:12.827 +04:00 [DBG] Authorize endpoint response
{"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ClientId":"insig_spa","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","State":"3c4cf1570ea24a5bbb26811afe0c8c05","Scope":"openid profile email insigapi.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2023-07-15 19:55:12.838 +04:00 [DBG] Start parsing Basic Authentication secret
2023-07-15 19:55:12.852 +04:00 [DBG] Start parsing for secret in post body
2023-07-15 19:55:12.890 +04:00 [DBG] client id without secret found
2023-07-15 19:55:12.896 +04:00 [DBG] Parser found secret: PostBodySecretParser
2023-07-15 19:55:12.901 +04:00 [DBG] Secret id found: insig_spa
2023-07-15 19:55:13.103 +04:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:4200
2023-07-15 19:55:13.135 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:13.155 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:13.209 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2023-07-15 19:55:13.217 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2023-07-15 19:55:13.220 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2023-07-15 19:55:13.224 +04:00 [DBG] Start token request.
2023-07-15 19:55:13.228 +04:00 [DBG] Start client validation
2023-07-15 19:55:13.242 +04:00 [DBG] Start parsing Basic Authentication secret
2023-07-15 19:55:13.258 +04:00 [DBG] Start parsing for secret in post body
2023-07-15 19:55:13.261 +04:00 [DBG] client id without secret found
2023-07-15 19:55:13.265 +04:00 [DBG] Parser found secret: PostBodySecretParser
2023-07-15 19:55:13.269 +04:00 [DBG] Secret id found: insig_spa
2023-07-15 19:55:13.296 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:13.303 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:13.312 +04:00 [DBG] Public Client - skipping secret validation success
2023-07-15 19:55:13.317 +04:00 [DBG] Client validation success
2023-07-15 19:55:13.369 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:13.372 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:13.377 +04:00 [DBG] Start token request validation
2023-07-15 19:55:13.381 +04:00 [DBG] Public Client - skipping secret validation success
2023-07-15 19:55:13.385 +04:00 [DBG] Client validation success
2023-07-15 19:55:13.388 +04:00 [DBG] Start token request validation
2023-07-15 19:55:13.406 +04:00 [DBG] Start validation of authorization code token request
2023-07-15 19:55:13.408 +04:00 [DBG] Start validation of authorization code token request
2023-07-15 19:55:13.443 +04:00 [DBG] c08VAiKMMTIKt4YjuGOzwrblB2KV9VwzR5+RuyngVVI= found in database: true
2023-07-15 19:55:13.447 +04:00 [DBG] N8S3cuVRca0j98BhT4fWwhBvBARyycN+6mIUeZ7XxFI= found in database: true
2023-07-15 19:55:13.597 +04:00 [DBG] removing c08VAiKMMTIKt4YjuGOzwrblB2KV9VwzR5+RuyngVVI= persisted grant from database
2023-07-15 19:55:13.599 +04:00 [DBG] removing N8S3cuVRca0j98BhT4fWwhBvBARyycN+6mIUeZ7XxFI= persisted grant from database
2023-07-15 19:55:13.640 +04:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2023-07-15 19:55:13.642 +04:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2023-07-15 19:55:13.670 +04:00 [DBG] Validation of authorization code token request success
2023-07-15 19:55:13.673 +04:00 [DBG] Validation of authorization code token request success
2023-07-15 19:55:13.688 +04:00 [INF] Token request validation success, {"ClientId":"insig_spa","ClientName":"Insig SPA","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****F822","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"insig_spa","code":"5A20FF2F42E632784DFF5BC448E1BDFC7640D1757B4CD97508426BE2C27BF822","redirect_uri":"http://localhost:4200/auth-callback","code_verifier":"70376a3dbf2642e6a6e14d1b9fc4b84ccbb9a93ecfe74ba8937f0df46acea79768bb3b6d0eb545fcb5bcd36a98acfe91","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2023-07-15 19:55:13.688 +04:00 [INF] Token request validation success, {"ClientId":"insig_spa","ClientName":"Insig SPA","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****10DA","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"insig_spa","code":"2428CD4BB8EBA5DC2F40196687813722B9053B2C06F41225D886309DA21210DA","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","code_verifier":"91164d2516b9413f82167ec726d4e6bc5f8b30a1f41e4ce9a8e61520ee44cb63836d8ceb0ecf459a961dd18ff88f37f3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2023-07-15 19:55:13.818 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:13.823 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:13.832 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:13.836 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:13.856 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:13.859 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:13.870 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:13.879 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:13.900 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:13.910 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:13.931 +04:00 [DBG] Getting claims for access token for client: insig_spa
2023-07-15 19:55:13.937 +04:00 [DBG] Getting claims for access token for client: insig_spa
2023-07-15 19:55:13.946 +04:00 [DBG] Getting claims for access token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:55:13.982 +04:00 [DBG] Getting claims for access token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:55:14.524 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:14.528 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:14.533 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:14.536 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:14.551 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:14.555 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:14.574 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:14.577 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:14.590 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:14.597 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:14.610 +04:00 [DBG] Getting claims for identity token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd and client: insig_spa
2023-07-15 19:55:14.617 +04:00 [DBG] Getting claims for identity token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd and client: insig_spa
2023-07-15 19:55:14.667 +04:00 [DBG] Token request success.
2023-07-15 19:55:14.668 +04:00 [DBG] Token request success.
2023-07-15 19:55:14.726 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:55:14.731 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:55:14.735 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:14.748 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:14.751 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:14.755 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:14.793 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:55:14.798 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:14.804 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:14.812 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2023-07-15 19:55:14.822 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2023-07-15 19:55:14.836 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2023-07-15 19:55:14.852 +04:00 [DBG] Start userinfo request
2023-07-15 19:55:14.859 +04:00 [DBG] Bearer token found in header
2023-07-15 19:55:15.034 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:15.039 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:15.116 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:15.119 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:15.134 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:55:15.142 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"4DE927CD185A5EB78BDC1199FC455489","Claims":{"nbf":1689436514,"exp":1689436814,"iss":"https://localhost:5000","aud":"insigapi","client_id":"insig_spa","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689433233,"idp":"local","email":"toengnrnaveed@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","jti":"4DE927CD185A5EB78BDC1199FC455489","sid":"959C1D985B489DFA133AC3C78871417D","iat":1689436514,"scope":["openid","profile","email","insigapi.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:55:15.158 +04:00 [DBG] Creating userinfo response
2023-07-15 19:55:15.171 +04:00 [DBG] Scopes in access token: openid profile email insigapi.read
2023-07-15 19:55:15.183 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:15.199 +04:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2023-07-15 19:55:15.330 +04:00 [INF] Profile service returned the following claim types: sub email preferred_username name email email_verified email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2023-07-15 19:55:15.335 +04:00 [DBG] End userinfo request
2023-07-15 19:55:15.447 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:55:15.456 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:15.485 +04:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2023-07-15 19:55:15.513 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:15.518 +04:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2023-07-15 19:55:15.527 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2023-07-15 19:55:15.552 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2023-07-15 19:55:15.565 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2023-07-15 19:55:15.570 +04:00 [DBG] Rendering check session result
2023-07-15 19:55:15.575 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2023-07-15 19:55:15.583 +04:00 [DBG] Start userinfo request
2023-07-15 19:55:15.586 +04:00 [DBG] Bearer token found in header
2023-07-15 19:55:15.730 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:15.736 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:15.942 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:15.949 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:16.005 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:55:16.013 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"59ADDF5E870005D7EFC4FCBBC5101826","Claims":{"nbf":1689436514,"exp":1689436814,"iss":"https://localhost:5000","aud":"insigapi","client_id":"insig_spa","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689433233,"idp":"local","email":"toengnrnaveed@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","jti":"59ADDF5E870005D7EFC4FCBBC5101826","sid":"959C1D985B489DFA133AC3C78871417D","iat":1689436514,"scope":["openid","profile","email","insigapi.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:55:16.024 +04:00 [DBG] Creating userinfo response
2023-07-15 19:55:16.029 +04:00 [DBG] Scopes in access token: openid profile email insigapi.read
2023-07-15 19:55:16.040 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:16.044 +04:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2023-07-15 19:55:16.061 +04:00 [INF] Profile service returned the following claim types: sub email preferred_username name email email_verified email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2023-07-15 19:55:16.065 +04:00 [DBG] End userinfo request
2023-07-15 19:55:28.362 +04:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2023-07-15 19:55:28.367 +04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2023-07-15 19:55:28.370 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2023-07-15 19:55:28.383 +04:00 [DBG] Processing signout request for 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:55:28.397 +04:00 [DBG] Start end session request validation
2023-07-15 19:55:28.413 +04:00 [DBG] Start identity token validation
2023-07-15 19:55:28.482 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:28.486 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:28.492 +04:00 [DBG] Client found: insig_spa / Insig SPA
2023-07-15 19:55:28.497 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:55:28.501 +04:00 [DBG] Token validation success
{"ClientId":"insig_spa","ClientName":"Insig SPA","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1689436514,"exp":1689436814,"iss":"https://localhost:5000","aud":"insig_spa","iat":1689436514,"at_hash":"DDu2Gi8sdfUXXQyc-nA2aw","s_hash":"BxAVXqf_jyprEmU3lG7Sww","sid":"959C1D985B489DFA133AC3C78871417D","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689433233,"idp":"local","email":"toengnrnaveed@gmail.com","preferred_username":"toengnrnaveed@gmail.com","name":"toengnrnaveed@gmail.com","email_verified":true,"http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:55:28.521 +04:00 [INF] End session request validation success
{"ClientId":"insig_spa","ClientName":"Insig SPA","SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","PostLogOutUri":null,"State":null,"Raw":{"id_token_hint":"***REDACTED***"},"$type":"EndSessionRequestValidationLog"}
2023-07-15 19:55:28.528 +04:00 [DBG] Success validating end session request from insig_spa
2023-07-15 19:55:28.766 +04:00 [DBG] removing 0 persisted grants from database for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":"insig_spa","Type":null,"$type":"PersistedGrantFilter"}
2023-07-15 19:55:28.787 +04:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2023-07-15 19:55:28.875 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:28.878 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:28.884 +04:00 [DBG] No client back-channel logout URLs
2023-07-15 19:55:28.891 +04:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2023-07-15 19:55:28.949 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:28.953 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:28.957 +04:00 [DBG] No client back-channel logout URLs
2023-07-15 19:55:30.256 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:55:30.269 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:55:30.279 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:55:30.288 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:55:30.295 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:55:30.299 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:55:30.304 +04:00 [DBG] Start discovery request
2023-07-15 19:55:30.345 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:55:30.397 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:55:30.400 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:55:30.405 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:55:30.410 +04:00 [DBG] Start authorize request
2023-07-15 19:55:30.414 +04:00 [DBG] No user present in authorize request
2023-07-15 19:55:30.422 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:55:30.516 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:30.522 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:30.527 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:55:30.539 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:30.557 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:30.566 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:30.569 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:55:30.573 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a9bc6039b940422cbe598fd4d0a5bfc0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a9bc6039b940422cbe598fd4d0a5bfc0","code_challenge":"o7YL0fYvrReug4DaYOQwgtx79laXzZvj2_zfNAgr0qI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:30.577 +04:00 [INF] Showing login: User is not authenticated
2023-07-15 19:55:30.582 +04:00 [INF] Changing response to LoginRequired: prompt=none was requested
2023-07-15 19:55:30.586 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a9bc6039b940422cbe598fd4d0a5bfc0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a9bc6039b940422cbe598fd4d0a5bfc0","code_challenge":"o7YL0fYvrReug4DaYOQwgtx79laXzZvj2_zfNAgr0qI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:34.430 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:55:34.437 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:55:34.446 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:55:34.449 +04:00 [DBG] Start authorize request
2023-07-15 19:55:34.457 +04:00 [DBG] No user present in authorize request
2023-07-15 19:55:34.465 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:55:34.545 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:34.550 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:34.553 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:55:34.566 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:34.575 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:34.584 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:34.587 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:55:34.593 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"85565613c8134265b9bbf02829977882","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"85565613c8134265b9bbf02829977882","code_challenge":"V6JdzfabChkJngiajauNaCUIefNG1mpJ1zlIe3Pd-lE","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:55:34.597 +04:00 [INF] Showing login: User is not authenticated
2023-07-15 19:55:34.788 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:55:34.861 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:55:34.864 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:55:34.867 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:55:34.878 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:55:34.904 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:55:34.919 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:55:34.926 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:55:58.039 +04:00 [DBG] Augmenting SignInContext
2023-07-15 19:55:58.042 +04:00 [DBG] Adding idp claim with value: local
2023-07-15 19:55:58.046 +04:00 [DBG] Adding auth_time claim with value: 1689436558
2023-07-15 19:56:08.238 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 19:56:08.633 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 19:56:08.642 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 19:56:08.648 +04:00 [DBG] Start authorize callback request
2023-07-15 19:56:08.652 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:56:08.655 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:56:08.733 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:08.742 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:08.751 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:56:08.763 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:08.774 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:08.797 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:08.801 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:56:08.805 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"85565613c8134265b9bbf02829977882","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"8BE754714B3CE7C07EA397314816614E","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"85565613c8134265b9bbf02829977882","code_challenge":"V6JdzfabChkJngiajauNaCUIefNG1mpJ1zlIe3Pd-lE","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:56:08.822 +04:00 [DBG] Client is configured to not require consent, no consent is required
2023-07-15 19:56:08.825 +04:00 [DBG] Creating Authorization Code Flow response.
2023-07-15 19:56:08.841 +04:00 [DBG] whoOqoIqZS+R9g7XK0lmS0AqK7zsHVlovOJN3K8UbyY= not found in database
2023-07-15 19:56:08.859 +04:00 [DBG] Authorize endpoint response
{"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ClientId":"insig_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"85565613c8134265b9bbf02829977882","Scope":"openid profile email insigapi.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2023-07-15 19:56:08.863 +04:00 [DBG] Augmenting SignInContext
2023-07-15 19:56:11.837 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:56:11.851 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:11.859 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:11.894 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:56:11.901 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:56:11.908 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:56:11.915 +04:00 [DBG] Start discovery request
2023-07-15 19:56:11.968 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:56:12.132 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:56:12.154 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:12.175 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:12.211 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:56:12.225 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:56:12.230 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:56:12.233 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:56:12.239 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:56:12.243 +04:00 [DBG] Start authorize request
2023-07-15 19:56:12.246 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:56:12.250 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:56:12.254 +04:00 [DBG] Start discovery request
2023-07-15 19:56:12.260 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:56:12.402 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:56:12.493 +04:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:4200
2023-07-15 19:56:12.513 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:12.607 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:12.670 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2023-07-15 19:56:12.708 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2023-07-15 19:56:12.717 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2023-07-15 19:56:12.725 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:12.729 +04:00 [DBG] Start token request.
2023-07-15 19:56:12.732 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:12.743 +04:00 [DBG] Start client validation
2023-07-15 19:56:12.748 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:56:12.752 +04:00 [DBG] Start parsing Basic Authentication secret
2023-07-15 19:56:12.757 +04:00 [DBG] Start parsing for secret in post body
2023-07-15 19:56:12.762 +04:00 [DBG] client id without secret found
2023-07-15 19:56:12.765 +04:00 [DBG] Parser found secret: PostBodySecretParser
2023-07-15 19:56:12.770 +04:00 [DBG] Secret id found: insig_spa
2023-07-15 19:56:12.792 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:12.857 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:12.883 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:12.890 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:56:12.905 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"3726a2c0ddd24029a3b58add54f09698","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"8BE754714B3CE7C07EA397314816614E","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"3726a2c0ddd24029a3b58add54f09698","code_challenge":"QnhjVwwwm74wLFiHyWON5hbaLpsV_mfXwbp_HOcsS_s","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:56:12.939 +04:00 [DBG] Client is configured to not require consent, no consent is required
2023-07-15 19:56:12.946 +04:00 [DBG] Creating Authorization Code Flow response.
2023-07-15 19:56:12.999 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:13.015 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:13.029 +04:00 [DBG] 2H5yYkByYQDhXWpEM3XFH5PUWKOcvQUFE5ZsIEJj2DM= not found in database
2023-07-15 19:56:13.033 +04:00 [DBG] Public Client - skipping secret validation success
2023-07-15 19:56:13.037 +04:00 [DBG] Client validation success
2023-07-15 19:56:13.045 +04:00 [DBG] Start token request validation
2023-07-15 19:56:13.049 +04:00 [DBG] Start validation of authorization code token request
2023-07-15 19:56:13.079 +04:00 [DBG] Authorize endpoint response
{"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ClientId":"insig_spa","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","State":"3726a2c0ddd24029a3b58add54f09698","Scope":"openid profile email insigapi.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2023-07-15 19:56:13.096 +04:00 [DBG] whoOqoIqZS+R9g7XK0lmS0AqK7zsHVlovOJN3K8UbyY= found in database: true
2023-07-15 19:56:13.467 +04:00 [DBG] removing whoOqoIqZS+R9g7XK0lmS0AqK7zsHVlovOJN3K8UbyY= persisted grant from database
2023-07-15 19:56:13.470 +04:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:4200
2023-07-15 19:56:13.474 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:13.479 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:13.492 +04:00 [DBG] Request path /connect/token matched to endpoint type Token
2023-07-15 19:56:13.500 +04:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2023-07-15 19:56:13.505 +04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2023-07-15 19:56:13.510 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2023-07-15 19:56:13.523 +04:00 [DBG] Start token request.
2023-07-15 19:56:13.528 +04:00 [DBG] Start client validation
2023-07-15 19:56:13.533 +04:00 [DBG] Start parsing Basic Authentication secret
2023-07-15 19:56:13.537 +04:00 [DBG] Start parsing for secret in post body
2023-07-15 19:56:13.542 +04:00 [DBG] client id without secret found
2023-07-15 19:56:13.567 +04:00 [DBG] Parser found secret: PostBodySecretParser
2023-07-15 19:56:13.571 +04:00 [DBG] Validation of authorization code token request success
2023-07-15 19:56:13.575 +04:00 [DBG] Secret id found: insig_spa
2023-07-15 19:56:13.581 +04:00 [INF] Token request validation success, {"ClientId":"insig_spa","ClientName":"Insig SPA","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****EAC2","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"insig_spa","code":"3338AEA80BFF5685B062C9619D422E335F1ADB30F3BDEE6E9D451BDAC390EAC2","redirect_uri":"http://localhost:4200/auth-callback","code_verifier":"8c7f5a7426964b639421c0d13800756b4702774df0b241a896123288777e2adf256387c5853545cdbc600eb18659dca4","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2023-07-15 19:56:13.810 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:13.818 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:13.823 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:13.828 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:13.835 +04:00 [DBG] Public Client - skipping secret validation success
2023-07-15 19:56:13.838 +04:00 [DBG] Client validation success
2023-07-15 19:56:13.847 +04:00 [DBG] Start token request validation
2023-07-15 19:56:13.851 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:13.877 +04:00 [DBG] Start validation of authorization code token request
2023-07-15 19:56:13.916 +04:00 [DBG] 2H5yYkByYQDhXWpEM3XFH5PUWKOcvQUFE5ZsIEJj2DM= found in database: true
2023-07-15 19:56:13.925 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:13.949 +04:00 [DBG] removing 2H5yYkByYQDhXWpEM3XFH5PUWKOcvQUFE5ZsIEJj2DM= persisted grant from database
2023-07-15 19:56:14.214 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:14.219 +04:00 [DBG] Getting claims for access token for client: insig_spa
2023-07-15 19:56:14.231 +04:00 [DBG] Getting claims for access token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:56:14.236 +04:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2023-07-15 19:56:14.273 +04:00 [DBG] Validation of authorization code token request success
2023-07-15 19:56:14.280 +04:00 [INF] Token request validation success, {"ClientId":"insig_spa","ClientName":"Insig SPA","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****AE54","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"insig_spa","code":"A87C8336BFC5BA962B3321F09AA3A091FEF2E6C06980BD5DD929E2266553AE54","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","code_verifier":"ba853a2ed49e4b0fb0d43f40afca1fbb702c3cfe12f34e4591ff8b5b6b884d7e8fe09d6537d349acb98be728fcef7474","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2023-07-15 19:56:14.430 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:14.434 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:14.439 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:14.450 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:14.475 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:14.482 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:14.521 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:14.548 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:14.557 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:14.562 +04:00 [DBG] Getting claims for access token for client: insig_spa
2023-07-15 19:56:14.567 +04:00 [DBG] Getting claims for access token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:56:14.584 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:14.594 +04:00 [DBG] Getting claims for identity token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd and client: insig_spa
2023-07-15 19:56:14.622 +04:00 [DBG] Token request success.
2023-07-15 19:56:22.199 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:56:22.205 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:22.209 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:22.230 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:56:22.237 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:22.241 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:22.249 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2023-07-15 19:56:22.260 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2023-07-15 19:56:22.268 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2023-07-15 19:56:22.272 +04:00 [DBG] Start userinfo request
2023-07-15 19:56:22.276 +04:00 [DBG] Bearer token found in header
2023-07-15 19:56:22.283 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:22.287 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:22.317 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:22.355 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:22.375 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:22.382 +04:00 [DBG] Getting claims for identity token for subject: 8a54875e-e7b9-4744-8684-3096f46d8fbd and client: insig_spa
2023-07-15 19:56:22.399 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:22.402 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:22.428 +04:00 [DBG] Token request success.
2023-07-15 19:56:22.480 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:22.484 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:22.497 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:56:22.501 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"26588DAB1389E2BDDBD56F0B46ECDF1C","Claims":{"nbf":1689436574,"exp":1689436874,"iss":"https://localhost:5000","aud":"insigapi","client_id":"insig_spa","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689436558,"idp":"local","email":"toengnrnaveed@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","jti":"26588DAB1389E2BDDBD56F0B46ECDF1C","sid":"8BE754714B3CE7C07EA397314816614E","iat":1689436574,"scope":["openid","profile","email","insigapi.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:56:22.504 +04:00 [DBG] Creating userinfo response
2023-07-15 19:56:22.507 +04:00 [DBG] Scopes in access token: openid profile email insigapi.read
2023-07-15 19:56:22.517 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:22.520 +04:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2023-07-15 19:56:22.534 +04:00 [INF] Profile service returned the following claim types: sub email preferred_username name email email_verified email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2023-07-15 19:56:22.537 +04:00 [DBG] End userinfo request
2023-07-15 19:56:22.548 +04:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2023-07-15 19:56:22.552 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:22.555 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:22.562 +04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2023-07-15 19:56:22.566 +04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2023-07-15 19:56:22.569 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2023-07-15 19:56:22.573 +04:00 [DBG] Start userinfo request
2023-07-15 19:56:22.576 +04:00 [DBG] Bearer token found in header
2023-07-15 19:56:22.631 +04:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2023-07-15 19:56:22.634 +04:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2023-07-15 19:56:22.649 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2023-07-15 19:56:22.653 +04:00 [DBG] Rendering check session result
2023-07-15 19:56:22.714 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:22.719 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:22.781 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:22.784 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:22.805 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:56:22.809 +04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"42CEF80358ACF3801A5728C274F4F375","Claims":{"nbf":1689436574,"exp":1689436874,"iss":"https://localhost:5000","aud":"insigapi","client_id":"insig_spa","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689436558,"idp":"local","email":"toengnrnaveed@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","jti":"42CEF80358ACF3801A5728C274F4F375","sid":"8BE754714B3CE7C07EA397314816614E","iat":1689436574,"scope":["openid","profile","email","insigapi.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:56:22.814 +04:00 [DBG] Creating userinfo response
2023-07-15 19:56:22.817 +04:00 [DBG] Scopes in access token: openid profile email insigapi.read
2023-07-15 19:56:22.829 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:22.832 +04:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2023-07-15 19:56:22.856 +04:00 [INF] Profile service returned the following claim types: sub email preferred_username name email email_verified email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2023-07-15 19:56:22.862 +04:00 [DBG] End userinfo request
2023-07-15 19:56:42.687 +04:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2023-07-15 19:56:42.691 +04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2023-07-15 19:56:42.694 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2023-07-15 19:56:42.700 +04:00 [DBG] Processing signout request for 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:56:42.704 +04:00 [DBG] Start end session request validation
2023-07-15 19:56:42.708 +04:00 [DBG] Start identity token validation
2023-07-15 19:56:42.808 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:42.811 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:42.815 +04:00 [DBG] Client found: insig_spa / Insig SPA
2023-07-15 19:56:42.820 +04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2023-07-15 19:56:42.824 +04:00 [DBG] Token validation success
{"ClientId":"insig_spa","ClientName":"Insig SPA","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1689436582,"exp":1689436882,"iss":"https://localhost:5000","aud":"insig_spa","iat":1689436582,"at_hash":"YDw-Mf2eo3o-23y9n1gXKQ","s_hash":"UqY6A9nIptr1EKk-JrLOJA","sid":"8BE754714B3CE7C07EA397314816614E","sub":"8a54875e-e7b9-4744-8684-3096f46d8fbd","auth_time":1689436558,"idp":"local","email":"toengnrnaveed@gmail.com","preferred_username":"toengnrnaveed@gmail.com","name":"toengnrnaveed@gmail.com","email_verified":true,"http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","amr":"pwd"},"$type":"TokenValidationLog"}
2023-07-15 19:56:42.828 +04:00 [INF] End session request validation success
{"ClientId":"insig_spa","ClientName":"Insig SPA","SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","PostLogOutUri":null,"State":null,"Raw":{"id_token_hint":"***REDACTED***"},"$type":"EndSessionRequestValidationLog"}
2023-07-15 19:56:42.831 +04:00 [DBG] Success validating end session request from insig_spa
2023-07-15 19:56:43.004 +04:00 [DBG] removing 0 persisted grants from database for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":"insig_spa","Type":null,"$type":"PersistedGrantFilter"}
2023-07-15 19:56:43.021 +04:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2023-07-15 19:56:43.227 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:43.231 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:43.236 +04:00 [DBG] No client back-channel logout URLs
2023-07-15 19:56:43.240 +04:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2023-07-15 19:56:43.303 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:43.306 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:43.310 +04:00 [DBG] No client back-channel logout URLs
2023-07-15 19:56:44.405 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 19:56:44.408 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 19:56:44.410 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 19:56:44.419 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 19:56:44.423 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 19:56:44.426 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 19:56:44.430 +04:00 [DBG] Start discovery request
2023-07-15 19:56:44.478 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 19:56:44.509 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:56:44.516 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:56:44.522 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:56:44.525 +04:00 [DBG] Start authorize request
2023-07-15 19:56:44.528 +04:00 [DBG] No user present in authorize request
2023-07-15 19:56:44.532 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:56:44.634 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:44.638 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:44.642 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:56:44.661 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:44.673 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:44.690 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:44.698 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:56:44.704 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4c6da1dad9b043b09c45c5d456aa72b5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"4c6da1dad9b043b09c45c5d456aa72b5","code_challenge":"7xut6I3Nm2V_tVWu_XN2WMMjwH2_DKMSGATeBILUZd0","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:56:44.709 +04:00 [INF] Showing login: User is not authenticated
2023-07-15 19:56:44.713 +04:00 [INF] Changing response to LoginRequired: prompt=none was requested
2023-07-15 19:56:44.718 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4c6da1dad9b043b09c45c5d456aa72b5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"4c6da1dad9b043b09c45c5d456aa72b5","code_challenge":"7xut6I3Nm2V_tVWu_XN2WMMjwH2_DKMSGATeBILUZd0","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:56:46.954 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 19:56:46.958 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 19:56:46.962 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 19:56:46.967 +04:00 [DBG] Start authorize request
2023-07-15 19:56:46.973 +04:00 [DBG] No user present in authorize request
2023-07-15 19:56:46.977 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:56:47.093 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:47.097 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:47.102 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:56:47.111 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:47.121 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:47.132 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:47.137 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:56:47.142 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5fe4895bfe9c4ac3b854504c4eda6d77","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"5fe4895bfe9c4ac3b854504c4eda6d77","code_challenge":"mIR1EFsmWa6oQyj-rYGQYOevyTiH3rNl5_prcbXojvI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:56:47.147 +04:00 [INF] Showing login: User is not authenticated
2023-07-15 19:56:47.255 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:56:47.342 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:56:47.345 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:56:47.349 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:56:47.360 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:56:47.374 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:56:47.386 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:56:47.390 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:57:01.617 +04:00 [DBG] Augmenting SignInContext
2023-07-15 19:57:01.620 +04:00 [DBG] Adding idp claim with value: local
2023-07-15 19:57:01.623 +04:00 [DBG] Adding auth_time claim with value: 1689436621
2023-07-15 19:57:01.661 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 19:57:01.674 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 19:57:01.678 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 19:57:01.682 +04:00 [DBG] Start authorize callback request
2023-07-15 19:57:01.686 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 19:57:01.689 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:57:01.754 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:57:01.757 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:57:01.760 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:57:01.771 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:57:01.794 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:57:01.804 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:57:01.808 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:57:01.812 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5fe4895bfe9c4ac3b854504c4eda6d77","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"5fe4895bfe9c4ac3b854504c4eda6d77","code_challenge":"mIR1EFsmWa6oQyj-rYGQYOevyTiH3rNl5_prcbXojvI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 19:57:01.840 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 19:57:01.844 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 19:57:01.847 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 19:57:01.851 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 19:57:01.948 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:57:02.029 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:57:02.032 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:57:02.036 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:57:02.049 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:57:02.063 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:57:02.072 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:57:02.076 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:57:15.919 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:57:16.061 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:57:16.065 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:57:16.069 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:57:16.089 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:57:16.171 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:57:16.192 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:57:16.195 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:57:50.369 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 19:57:50.447 +04:00 [DBG] insig_spa found in database: true
2023-07-15 19:57:50.452 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 19:57:50.455 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 19:57:50.472 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 19:57:50.497 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 19:57:50.512 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 19:57:50.517 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 19:57:51.738 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty. (Parameter 'url')
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at Insig.IdentityServer.Controllers.Consent.ConsentController.Index(ConsentInputModel model) in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Controllers\Consent\ConsentController.cs:line 74
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.CspMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Insig.Common.Configuration.ApplicationBuilderExtensions.<>c.<<RemoveServerHeader>b__0_0>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.Common\Configuration\ApplicationBuilderExtensions.cs:line 15
--- End of stack trace from previous location ---
   at Insig.IdentityServer.Startup.<>c.<<Configure>b__7_1>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Startup.cs:line 208
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2023-07-15 20:02:26.559 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:02:26.646 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:02:26.651 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:02:26.657 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:02:26.681 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:02:26.701 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:02:26.714 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:02:26.717 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:02:35.268 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:02:35.405 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:02:35.409 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:02:35.412 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:02:35.420 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:02:35.428 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:02:35.437 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:02:35.440 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:04:45.549 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:04:45.646 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:04:45.649 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:04:45.653 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:04:45.668 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:04:45.694 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:04:45.706 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:04:45.709 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:04:45.774 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 20:04:45.777 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 20:04:45.780 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 20:04:45.782 +04:00 [DBG] Start authorize callback request
2023-07-15 20:04:45.786 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:04:45.789 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:04:45.835 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:04:45.838 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:04:45.841 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:04:45.851 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:04:45.858 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:04:45.865 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:04:45.868 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:04:45.870 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5fe4895bfe9c4ac3b854504c4eda6d77","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"5fe4895bfe9c4ac3b854504c4eda6d77","code_challenge":"mIR1EFsmWa6oQyj-rYGQYOevyTiH3rNl5_prcbXojvI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:04:45.881 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:04:45.883 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:04:45.887 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:04:45.889 +04:00 [INF] Error: User denied consent to required scopes
2023-07-15 20:04:45.892 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5fe4895bfe9c4ac3b854504c4eda6d77","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"5fe4895bfe9c4ac3b854504c4eda6d77","code_challenge":"mIR1EFsmWa6oQyj-rYGQYOevyTiH3rNl5_prcbXojvI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:04:47.380 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 20:04:47.382 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 20:04:47.395 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 20:04:47.428 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 20:04:47.431 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 20:04:47.435 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 20:04:47.440 +04:00 [DBG] Start discovery request
2023-07-15 20:04:47.487 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 20:04:47.651 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:04:47.655 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:04:47.683 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:04:47.688 +04:00 [DBG] Start authorize request
2023-07-15 20:04:47.691 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:04:47.694 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:04:47.900 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:04:47.920 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:04:47.924 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:04:47.937 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:04:47.946 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:04:47.964 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:04:47.967 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:04:47.972 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b0e9a1e7cd3042af88cb73a1b2c250c7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"b0e9a1e7cd3042af88cb73a1b2c250c7","code_challenge":"mSaTz45YTAgIumHpcty5DtyQctTEy-dPexPjIpfru4I","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:04:47.994 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:04:47.997 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:04:48.000 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:04:48.002 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 20:04:48.007 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b0e9a1e7cd3042af88cb73a1b2c250c7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"b0e9a1e7cd3042af88cb73a1b2c250c7","code_challenge":"mSaTz45YTAgIumHpcty5DtyQctTEy-dPexPjIpfru4I","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:12:08.235 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:12:08.239 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:12:08.242 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:12:08.245 +04:00 [DBG] Start authorize request
2023-07-15 20:12:08.250 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:12:08.253 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:12:08.356 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:12:08.359 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:12:08.361 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:12:08.384 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:12:08.403 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:12:08.417 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:12:08.420 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:12:08.423 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c7f3e360fd254c8db44704e11b86d638","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"c7f3e360fd254c8db44704e11b86d638","code_challenge":"dinfumWroOLK-erCBAO04tStWZtwZ6ZNHDU7E1CXJ9Y","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:12:08.438 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:12:08.441 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:12:08.443 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:12:08.447 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 20:12:08.645 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:12:08.749 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:12:08.752 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:12:08.755 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:12:08.766 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:12:08.773 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:12:08.782 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:12:08.786 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:12:23.442 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:12:23.571 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:12:23.574 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:12:23.577 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:12:23.585 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:12:23.594 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:12:23.601 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:12:23.604 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:13:05.571 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:13:05.704 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:13:05.706 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:13:05.709 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:13:05.720 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:13:05.749 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:13:05.759 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:13:05.763 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:06.773 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:06.852 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:06.854 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:06.857 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:06.874 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:06.892 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:06.904 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:06.907 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:08.931 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 20:14:08.934 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 20:14:08.937 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 20:14:08.955 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 20:14:08.962 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 20:14:08.965 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 20:14:08.967 +04:00 [DBG] Start discovery request
2023-07-15 20:14:09.029 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 20:14:09.298 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:14:09.303 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:14:09.308 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:14:09.312 +04:00 [DBG] Start authorize request
2023-07-15 20:14:09.317 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:14:09.335 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:09.529 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:09.533 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:09.537 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:09.548 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:09.559 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:09.569 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:09.573 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:09.577 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"72754a56c8624dc4bc632fb5ab65d7f9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"72754a56c8624dc4bc632fb5ab65d7f9","code_challenge":"qTbzLJ2EpHC0Fj7oUP6Nz3ppNx0D1-kv0jkSHaXADO0","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:09.599 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:14:09.606 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:14:09.612 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:14:09.615 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 20:14:09.618 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"72754a56c8624dc4bc632fb5ab65d7f9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"72754a56c8624dc4bc632fb5ab65d7f9","code_challenge":"qTbzLJ2EpHC0Fj7oUP6Nz3ppNx0D1-kv0jkSHaXADO0","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:28.513 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:14:28.516 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:14:28.522 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:14:28.526 +04:00 [DBG] Start authorize request
2023-07-15 20:14:28.529 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:14:28.533 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:28.625 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:28.628 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:28.632 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:28.647 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:28.659 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:28.668 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:28.674 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:28.678 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"be94143dda8d49ed8a655a2555871ada","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"be94143dda8d49ed8a655a2555871ada","code_challenge":"p2P6bYLs3EVEDtobD6ujlt_UENOcdmvjznYatdRLRes","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:28.701 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:14:28.706 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:14:28.710 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:14:28.714 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 20:14:28.864 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:29.027 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:29.045 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:29.049 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:29.077 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:29.086 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:29.097 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:29.101 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:38.181 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:38.243 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:38.246 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:38.249 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:38.258 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:38.269 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:38.279 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:38.282 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:39.062 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:39.121 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:39.124 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:39.126 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:39.136 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:39.144 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:39.155 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:39.158 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:39.199 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 20:14:39.205 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 20:14:39.209 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 20:14:39.212 +04:00 [DBG] Start authorize callback request
2023-07-15 20:14:39.215 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:14:39.218 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:39.278 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:39.282 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:39.306 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:39.331 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:39.342 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:39.351 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:39.357 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:39.361 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"be94143dda8d49ed8a655a2555871ada","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"be94143dda8d49ed8a655a2555871ada","code_challenge":"p2P6bYLs3EVEDtobD6ujlt_UENOcdmvjznYatdRLRes","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:39.402 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:14:39.405 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:14:39.409 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:14:39.412 +04:00 [INF] Error: User denied consent to required scopes
2023-07-15 20:14:39.416 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"be94143dda8d49ed8a655a2555871ada","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"be94143dda8d49ed8a655a2555871ada","code_challenge":"p2P6bYLs3EVEDtobD6ujlt_UENOcdmvjznYatdRLRes","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:40.968 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 20:14:40.971 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 20:14:40.973 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 20:14:41.004 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 20:14:41.007 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 20:14:41.012 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 20:14:41.015 +04:00 [DBG] Start discovery request
2023-07-15 20:14:41.066 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 20:14:41.220 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:14:41.223 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:14:41.226 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:14:41.230 +04:00 [DBG] Start authorize request
2023-07-15 20:14:41.236 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:14:41.243 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:14:41.302 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:14:41.308 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:14:41.312 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:14:41.322 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:14:41.330 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:14:41.339 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:14:41.343 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:14:41.355 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"26032cdbb3cd4ec1974b1c07b6b4e6f8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"26032cdbb3cd4ec1974b1c07b6b4e6f8","code_challenge":"t4UFXp8ed0sC6TZZ5TvqtukzIx_hJSVhYcwX-9XiuAs","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:14:41.398 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:14:41.403 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:14:41.405 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:14:41.408 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 20:14:41.411 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"26032cdbb3cd4ec1974b1c07b6b4e6f8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"26032cdbb3cd4ec1974b1c07b6b4e6f8","code_challenge":"t4UFXp8ed0sC6TZZ5TvqtukzIx_hJSVhYcwX-9XiuAs","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:20:14.136 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:20:14.139 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:20:14.142 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:20:14.148 +04:00 [DBG] Start authorize request
2023-07-15 20:20:14.151 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:20:14.154 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:14.307 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:14.309 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:14.315 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:14.328 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:14.353 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:14.368 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:14.371 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:14.375 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae0d1140ad6449e7ade4235fb2678db2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"ae0d1140ad6449e7ade4235fb2678db2","code_challenge":"6xESpI-GGVdnJKDLj_e-gnhT3BXaPORvUM3AhulXz9I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:20:14.397 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:20:14.400 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:20:14.403 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:20:14.406 +04:00 [INF] Showing consent: User has not yet consented
2023-07-15 20:20:14.544 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:14.605 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:14.608 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:14.611 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:14.620 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:14.627 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:14.635 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:14.639 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:25.484 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:25.573 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:25.576 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:25.579 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:25.593 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:25.615 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:25.627 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:25.631 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:27.718 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:27.814 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:27.818 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:27.823 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:27.853 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:27.873 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:27.902 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:27.905 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:27.980 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-15 20:20:27.984 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-15 20:20:27.988 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-15 20:20:27.991 +04:00 [DBG] Start authorize callback request
2023-07-15 20:20:27.998 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:20:28.001 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:28.061 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:28.064 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:28.068 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:28.078 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:28.085 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:28.094 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:28.097 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:28.101 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae0d1140ad6449e7ade4235fb2678db2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"ae0d1140ad6449e7ade4235fb2678db2","code_challenge":"6xESpI-GGVdnJKDLj_e-gnhT3BXaPORvUM3AhulXz9I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:20:28.226 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:20:28.235 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:20:28.242 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:20:28.246 +04:00 [INF] Error: User denied consent to required scopes
2023-07-15 20:20:28.259 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae0d1140ad6449e7ade4235fb2678db2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"ae0d1140ad6449e7ade4235fb2678db2","code_challenge":"6xESpI-GGVdnJKDLj_e-gnhT3BXaPORvUM3AhulXz9I","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:20:30.396 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-15 20:20:30.401 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-15 20:20:30.405 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-15 20:20:30.416 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-15 20:20:30.427 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-15 20:20:30.452 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-15 20:20:30.464 +04:00 [DBG] Start discovery request
2023-07-15 20:20:30.542 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-15 20:20:30.660 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-15 20:20:30.665 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-15 20:20:30.669 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-15 20:20:30.673 +04:00 [DBG] Start authorize request
2023-07-15 20:20:30.699 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-15 20:20:30.705 +04:00 [DBG] Start authorize request protocol validation
2023-07-15 20:20:30.899 +04:00 [DBG] insig_spa found in database: true
2023-07-15 20:20:30.932 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-15 20:20:30.944 +04:00 [DBG] Checking for PKCE parameters
2023-07-15 20:20:31.022 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-15 20:20:31.031 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-15 20:20:31.042 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-15 20:20:31.045 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-15 20:20:31.049 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d3a332bca245410684d79ed1c6f8908f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d3a332bca245410684d79ed1c6f8908f","code_challenge":"TZrKQt4pWuliNl9W3PraLB6zxFxepbe5vhp4xgkc6Ys","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-15 20:20:31.097 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-15 20:20:31.102 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-15 20:20:31.106 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-15 20:20:31.115 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-15 20:20:31.120 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d3a332bca245410684d79ed1c6f8908f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d3a332bca245410684d79ed1c6f8908f","code_challenge":"TZrKQt4pWuliNl9W3PraLB6zxFxepbe5vhp4xgkc6Ys","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:11:45.300 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:11:45.382 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:11:45.386 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:11:45.390 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:11:45.393 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:11:45.396 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:11:45.400 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:11:45.417 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:11:45.422 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:11:45.425 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:11:45.428 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:11:45.432 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:11:45.436 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:11:45.439 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:11:51.362 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 00:11:51.369 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 00:11:51.372 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 00:11:51.375 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 00:11:51.377 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 00:11:51.381 +04:00 [DBG] Error Url: /home/error
2023-07-16 00:11:51.385 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 00:11:52.616 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:11:52.903 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:11:52.907 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:11:52.926 +04:00 [DBG] Start authorize request
2023-07-16 00:11:52.987 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:11:53.201 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:11:54.992 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:11:55.083 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:11:55.140 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:11:55.423 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:11:55.518 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:11:55.688 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:11:55.845 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:11:55.879 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:11:55.907 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:11:55.985 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:11:56.055 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d49dafc4f1154609b2c5237f3704fdb7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"d49dafc4f1154609b2c5237f3704fdb7","code_challenge":"NLybiybf9AgAu0J53IQK7-CVdWFVmeQWOlUWnFp2S2o","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:11:56.126 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:11:56.136 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:11:56.142 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:11:56.151 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:11:56.806 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:11:56.904 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:11:56.907 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:11:56.910 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:11:56.922 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:11:56.938 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:11:56.951 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:11:56.956 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:17:39.348 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:17:39.360 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:17:39.364 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:17:39.380 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:17:39.387 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:17:39.391 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:17:39.398 +04:00 [DBG] Start discovery request
2023-07-16 00:17:39.458 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:17:39.609 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:17:39.666 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:17:39.693 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:17:39.863 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:17:39.867 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:17:39.871 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:17:39.877 +04:00 [DBG] Start authorize request
2023-07-16 00:17:39.882 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:17:39.887 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:17:40.012 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:17:40.016 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:17:40.021 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:17:40.039 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:17:40.076 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:17:40.089 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:17:40.094 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:17:40.100 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"8f641a814355462aa08d253f26891ae3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"8f641a814355462aa08d253f26891ae3","code_challenge":"dCeIaqvUAbg7mJuhEhKUSvjBS6F9_135VepDhyLIS2A","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:17:40.119 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:17:40.124 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:17:40.127 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:17:40.132 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:17:40.139 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"8f641a814355462aa08d253f26891ae3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"8f641a814355462aa08d253f26891ae3","code_challenge":"dCeIaqvUAbg7mJuhEhKUSvjBS6F9_135VepDhyLIS2A","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:17:43.450 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:17:43.465 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:17:43.468 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:17:43.475 +04:00 [DBG] Start authorize request
2023-07-16 00:17:43.478 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:17:43.481 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:17:43.546 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:17:43.549 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:17:43.555 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:17:43.564 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:17:43.586 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:17:43.600 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:17:43.606 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:17:43.609 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae881dc281954bbc8cb4a66eda2b768b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"ae881dc281954bbc8cb4a66eda2b768b","code_challenge":"EgG3euoPZi4_8G64BNu8PK4Xg9kj48DghK-CWNkeNWo","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:17:43.648 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:17:43.651 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:17:43.656 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:17:43.659 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:17:43.764 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:17:43.857 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:17:43.860 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:17:43.863 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:17:43.875 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:17:43.883 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:17:43.893 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:17:43.896 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:18:38.157 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:18:38.163 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:18:38.167 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:18:38.172 +04:00 [DBG] Start authorize request
2023-07-16 00:18:38.175 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:18:38.179 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:18:38.683 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:18:38.692 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:18:38.697 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:18:38.756 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:18:38.797 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:18:38.819 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:18:38.828 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:18:38.833 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae6a14e305064821897c8f9dc494128f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"ae6a14e305064821897c8f9dc494128f","code_challenge":"hEdwx-rR4gDdJQuC1qy2-sOLqwFkV-Ihlux4ZklqW34","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:18:38.895 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:18:38.900 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:18:38.908 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:18:38.912 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:18:38.926 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ae6a14e305064821897c8f9dc494128f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"ae6a14e305064821897c8f9dc494128f","code_challenge":"hEdwx-rR4gDdJQuC1qy2-sOLqwFkV-Ihlux4ZklqW34","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:18:41.521 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:18:41.525 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:18:41.528 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:18:41.531 +04:00 [DBG] Start authorize request
2023-07-16 00:18:41.534 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:18:41.541 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:18:41.610 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:18:41.618 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:18:41.624 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:18:41.634 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:18:41.645 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:18:41.656 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:18:41.659 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:18:41.663 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d2d5afb72fe94614b26e84c051ae32fa","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"d2d5afb72fe94614b26e84c051ae32fa","code_challenge":"N6KIA0UO4b6KcyFMr5iATklE7k65No33OOW3lKGLLeU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:18:41.677 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:18:41.681 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:18:41.685 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:18:41.689 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:18:41.786 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:18:41.861 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:18:41.864 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:18:41.867 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:18:41.898 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:18:41.909 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:18:41.953 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:18:41.965 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:19:49.021 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:19:49.026 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:19:49.031 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:19:49.036 +04:00 [DBG] Start authorize request
2023-07-16 00:19:49.040 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:19:49.050 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:19:49.283 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:19:49.286 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:19:49.290 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:19:49.308 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:19:49.341 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:19:49.378 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:19:49.382 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:19:49.387 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c5277c73ee2a4f50a6468276d74bc61f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"c5277c73ee2a4f50a6468276d74bc61f","code_challenge":"bGzzrxYVTCYKLXoG5dsNYO_ymeHlsY_SuUV8eLOpjrk","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:19:49.436 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:19:49.441 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:19:49.486 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:19:49.515 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:19:49.525 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c5277c73ee2a4f50a6468276d74bc61f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"c5277c73ee2a4f50a6468276d74bc61f","code_challenge":"bGzzrxYVTCYKLXoG5dsNYO_ymeHlsY_SuUV8eLOpjrk","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:19:50.296 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:19:50.305 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:19:50.308 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:19:50.313 +04:00 [DBG] Start authorize request
2023-07-16 00:19:50.320 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:19:50.323 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:19:50.436 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:19:50.441 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:19:50.445 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:19:50.459 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:19:50.470 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:19:50.479 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:19:50.484 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:19:50.488 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"402690d27b3d451f88ea43394ea1c541","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"402690d27b3d451f88ea43394ea1c541","code_challenge":"rkd2Mtbz2ECAovUOmfmLrWqsh70qHrxf8eGUJaiwrI8","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:19:50.521 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:19:50.524 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:19:50.527 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:19:50.530 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:19:50.695 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:19:50.981 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:19:50.985 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:19:50.988 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:19:51.000 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:19:51.011 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:19:51.027 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:19:51.031 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:31:18.389 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:31:18.393 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:31:18.396 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:31:18.401 +04:00 [DBG] Start discovery request
2023-07-16 00:31:18.448 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:34:16.017 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:34:16.020 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:34:16.023 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:34:16.032 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:34:16.037 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:34:16.040 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:34:16.044 +04:00 [DBG] Start discovery request
2023-07-16 00:34:16.093 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:34:16.156 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:34:16.159 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:34:16.161 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:34:16.165 +04:00 [DBG] Start authorize request
2023-07-16 00:34:16.170 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:34:16.173 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:16.258 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:16.261 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:16.265 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:16.281 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:16.311 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:16.322 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:16.325 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:16.328 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b1b24c60bc4c436481f88337e1824d08","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"b1b24c60bc4c436481f88337e1824d08","code_challenge":"MkXU8zchfLa5IAODcSlo2eTazjsCGs103rfYKH7tuMI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:16.340 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:34:16.346 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:34:16.350 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:34:16.353 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:34:16.356 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b1b24c60bc4c436481f88337e1824d08","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"b1b24c60bc4c436481f88337e1824d08","code_challenge":"MkXU8zchfLa5IAODcSlo2eTazjsCGs103rfYKH7tuMI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:20.937 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:34:20.942 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:34:20.947 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:34:20.954 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:34:20.957 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:34:20.960 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:34:20.965 +04:00 [DBG] Start discovery request
2023-07-16 00:34:20.993 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:34:21.047 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:34:21.053 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:34:21.060 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:34:21.068 +04:00 [DBG] Start authorize request
2023-07-16 00:34:21.072 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:34:21.076 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:21.173 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:21.178 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:21.181 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:21.198 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:21.207 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:21.216 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:21.220 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:21.224 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4f6b501a9cf443038996013eddf793c8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"4f6b501a9cf443038996013eddf793c8","code_challenge":"HuXqDbu4pGWXFzKPioY4EfmZW7LlDXHmc2r67WvbST8","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:21.259 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:34:21.262 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:34:21.264 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:34:21.268 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:34:21.272 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4f6b501a9cf443038996013eddf793c8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"4f6b501a9cf443038996013eddf793c8","code_challenge":"HuXqDbu4pGWXFzKPioY4EfmZW7LlDXHmc2r67WvbST8","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:26.764 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:34:26.768 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:34:26.785 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:34:26.793 +04:00 [DBG] Start authorize request
2023-07-16 00:34:26.796 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:34:26.799 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:26.898 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:26.901 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:26.904 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:26.922 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:26.955 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:26.983 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:26.986 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:26.990 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4234f9ebf72245c19659a5a3608a771f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"4234f9ebf72245c19659a5a3608a771f","code_challenge":"IJ-xaU0mnN1c38Ks48VSQtMs3dp8wWGZQCIDVZEM9to","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:27.019 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:34:27.022 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:34:27.027 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:34:27.030 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:34:27.110 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:27.217 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:27.220 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:27.223 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:27.239 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:27.270 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:27.280 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:27.284 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:49.174 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:49.261 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:49.265 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:49.267 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:49.279 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:49.302 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:49.313 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:49.315 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:49.355 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:49.411 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:49.414 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:49.417 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:49.428 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:49.438 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:49.448 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:49.453 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:49.511 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 00:34:49.515 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 00:34:49.520 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 00:34:49.530 +04:00 [DBG] Start authorize callback request
2023-07-16 00:34:49.540 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:34:49.543 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:49.608 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:49.611 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:49.615 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:49.626 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:49.633 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:49.645 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:49.648 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:49.652 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4234f9ebf72245c19659a5a3608a771f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"4234f9ebf72245c19659a5a3608a771f","code_challenge":"IJ-xaU0mnN1c38Ks48VSQtMs3dp8wWGZQCIDVZEM9to","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:49.678 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:34:49.681 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:34:49.689 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:34:49.696 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 00:34:49.700 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"4234f9ebf72245c19659a5a3608a771f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"4234f9ebf72245c19659a5a3608a771f","code_challenge":"IJ-xaU0mnN1c38Ks48VSQtMs3dp8wWGZQCIDVZEM9to","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:50.829 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:34:50.833 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:34:50.840 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:34:50.864 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:34:50.871 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:34:50.906 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:34:50.911 +04:00 [DBG] Start discovery request
2023-07-16 00:34:50.960 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:34:50.994 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:34:50.999 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:34:51.003 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:34:51.009 +04:00 [DBG] Start authorize request
2023-07-16 00:34:51.013 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:34:51.016 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:34:51.108 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:34:51.110 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:34:51.113 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:34:51.121 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:34:51.129 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:34:51.140 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:34:51.143 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:34:51.146 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a180c73493d344d095cf4f7dbe4a4a57","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a180c73493d344d095cf4f7dbe4a4a57","code_challenge":"fairsWiebXZpqT9ln3C6A7sej2TdwlgX6WQmC7x0cPI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:34:51.172 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:34:51.175 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:34:51.178 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:34:51.181 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:34:51.186 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a180c73493d344d095cf4f7dbe4a4a57","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a180c73493d344d095cf4f7dbe4a4a57","code_challenge":"fairsWiebXZpqT9ln3C6A7sej2TdwlgX6WQmC7x0cPI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:35:12.409 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:35:12.414 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:35:12.417 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:35:12.425 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:35:12.429 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:35:12.434 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:35:12.438 +04:00 [DBG] Start discovery request
2023-07-16 00:35:12.495 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:35:12.573 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:35:12.577 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:35:12.580 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:35:12.585 +04:00 [DBG] Start authorize request
2023-07-16 00:35:12.589 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:35:12.595 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:35:12.679 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:35:12.684 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:35:12.688 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:35:12.708 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:35:12.719 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:35:12.727 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:35:12.730 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:35:12.734 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5e5b7717eac34365ab567d9402018e5c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5e5b7717eac34365ab567d9402018e5c","code_challenge":"g845EVFtq6RzB6b_s2CYAc5t_aVl-2iLim0P8DgoL7U","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:35:12.758 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:35:12.765 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:35:12.777 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:35:12.782 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:35:12.787 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5e5b7717eac34365ab567d9402018e5c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5e5b7717eac34365ab567d9402018e5c","code_challenge":"g845EVFtq6RzB6b_s2CYAc5t_aVl-2iLim0P8DgoL7U","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:36:08.236 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:36:08.303 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:36:08.306 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:36:08.309 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:36:08.312 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:36:08.315 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:36:08.322 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:36:08.341 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:36:08.346 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:36:08.348 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:36:08.352 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:36:08.355 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:36:08.358 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:36:08.361 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:36:15.828 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 00:36:15.834 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 00:36:15.840 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 00:36:15.846 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 00:36:15.849 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 00:36:15.854 +04:00 [DBG] Error Url: /home/error
2023-07-16 00:36:15.857 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 00:36:17.566 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:36:17.631 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:36:17.634 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:36:17.644 +04:00 [DBG] Start authorize request
2023-07-16 00:36:17.686 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:36:17.710 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:36:19.311 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:36:19.335 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:36:19.386 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:36:19.632 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:36:19.688 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:36:19.821 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:36:19.980 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:36:20.023 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:36:20.175 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:36:20.278 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:36:20.346 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"7aa619d9a03c44098680105646591eb3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"7aa619d9a03c44098680105646591eb3","code_challenge":"opPr1DNvSLXX1fvJq1FcBhlRCrtH3Hix4Hg5DKsD5ko","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:36:20.419 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:36:20.427 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:36:20.431 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:36:20.435 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:36:21.095 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:36:21.220 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:36:21.223 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:36:21.226 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:36:21.238 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:36:21.248 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:36:21.258 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:36:21.264 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:08.338 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:42:08.402 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:42:08.405 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:42:08.408 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:42:08.412 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:42:08.415 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:42:08.418 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:42:08.435 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 00:42:08.441 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 00:42:08.444 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 00:42:08.446 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 00:42:08.449 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 00:42:08.451 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 00:42:08.454 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 00:42:18.291 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 00:42:18.298 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 00:42:18.300 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 00:42:18.303 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 00:42:18.305 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 00:42:18.308 +04:00 [DBG] Error Url: /home/error
2023-07-16 00:42:18.317 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 00:42:20.233 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:20.439 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:21.641 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:21.641 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:21.665 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:21.669 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:21.699 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:21.700 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:21.896 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:22.041 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:22.041 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:22.353 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:22.967 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:22.972 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:23.074 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:23.342 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:23.403 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:23.502 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:23.503 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:23.591 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:23.753 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:23.762 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:23.767 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:23.787 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:23.803 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:23.876 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:23.893 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:24.175 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:42:24.189 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:42:24.201 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:42:24.230 +04:00 [DBG] Start authorize request
2023-07-16 00:42:24.249 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:42:24.253 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:24.400 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:24.404 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:24.408 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:24.483 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:24.513 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:24.542 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:24.551 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:24.616 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e88f846cccb74f4f91e11b70dd246470","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"e88f846cccb74f4f91e11b70dd246470","code_challenge":"XoKjxLVeEpYvwRdnzvDgN-rf1r99oHeH62fARrMaSFY","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:24.790 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:42:24.803 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:42:24.834 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:42:24.850 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:42:24.865 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e88f846cccb74f4f91e11b70dd246470","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"e88f846cccb74f4f91e11b70dd246470","code_challenge":"XoKjxLVeEpYvwRdnzvDgN-rf1r99oHeH62fARrMaSFY","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:25.418 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:42:25.428 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:42:25.439 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:42:25.459 +04:00 [DBG] Start authorize request
2023-07-16 00:42:25.491 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:42:25.498 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:25.602 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:25.632 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:25.637 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:25.654 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:25.673 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:25.734 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:25.740 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:25.751 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"fde1399e095f4493baa3093b20003611","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"fde1399e095f4493baa3093b20003611","code_challenge":"tMc-Wi5u3v5K-ugGMuWgaNQSBoC2KA_NzQQGPB2t4rI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:25.775 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:42:25.780 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:42:25.783 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:42:25.787 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:42:26.044 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:26.191 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:26.197 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:26.203 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:26.218 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:26.242 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:26.281 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:26.286 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:40.262 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:40.361 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:40.364 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:40.368 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:40.383 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:40.393 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:40.400 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:40.406 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:40.411 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:40.477 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:40.481 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:40.485 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:40.507 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:40.536 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:40.713 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:40.887 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:40.931 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 00:42:40.935 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 00:42:40.938 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 00:42:40.968 +04:00 [DBG] Start authorize callback request
2023-07-16 00:42:40.980 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:42:40.983 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:41.193 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:41.197 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:41.200 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:41.213 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:41.245 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:41.263 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:41.267 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:41.272 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"fde1399e095f4493baa3093b20003611","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"fde1399e095f4493baa3093b20003611","code_challenge":"tMc-Wi5u3v5K-ugGMuWgaNQSBoC2KA_NzQQGPB2t4rI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:41.301 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:42:41.306 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:42:41.312 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:42:41.321 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 00:42:41.326 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"fde1399e095f4493baa3093b20003611","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"fde1399e095f4493baa3093b20003611","code_challenge":"tMc-Wi5u3v5K-ugGMuWgaNQSBoC2KA_NzQQGPB2t4rI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:42.840 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 00:42:42.848 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 00:42:42.874 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 00:42:42.889 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 00:42:42.897 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 00:42:42.902 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 00:42:42.911 +04:00 [DBG] Start discovery request
2023-07-16 00:42:43.112 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:43.430 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:43.509 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 00:42:43.536 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 00:42:43.636 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:42:43.652 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:42:43.659 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:42:43.697 +04:00 [DBG] Start authorize request
2023-07-16 00:42:43.702 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:42:43.711 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:42:43.785 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:42:43.791 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:42:43.794 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:42:43.807 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:42:43.815 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:42:43.823 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:42:43.826 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:42:43.829 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"65b8fda31468434ba0063ca81e835422","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"65b8fda31468434ba0063ca81e835422","code_challenge":"xdzNCh6aRxfzL1eH1V5IclZEpE2oOboFOmALnF2MZOo","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:42:43.854 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:42:43.856 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:42:43.859 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:42:43.862 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 00:42:43.868 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"65b8fda31468434ba0063ca81e835422","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"65b8fda31468434ba0063ca81e835422","code_challenge":"xdzNCh6aRxfzL1eH1V5IclZEpE2oOboFOmALnF2MZOo","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:47:17.258 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 00:47:17.261 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 00:47:17.265 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 00:47:17.269 +04:00 [DBG] Start authorize request
2023-07-16 00:47:17.276 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 00:47:17.282 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:47:17.416 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:47:17.422 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:47:17.426 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:47:17.445 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:47:17.477 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:47:17.493 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:47:17.496 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 00:47:17.499 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"bf7b511d4e374ac28f74afd674f13336","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"bf7b511d4e374ac28f74afd674f13336","code_challenge":"UOnVO_uTUvrhlJNRK8K8EBsUbtquJMsw1kpQ6_3ki74","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 00:47:17.518 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 00:47:17.523 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 00:47:17.526 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 00:47:17.529 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 00:47:17.830 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 00:47:17.923 +04:00 [DBG] insig_spa found in database: true
2023-07-16 00:47:17.927 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 00:47:17.935 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 00:47:17.950 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 00:47:17.960 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 00:47:17.972 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 00:47:17.975 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:23:48.694 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 01:23:48.783 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 01:23:48.786 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 01:23:48.790 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 01:23:48.793 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 01:23:48.796 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 01:23:48.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 01:23:48.885 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 01:23:48.949 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 01:23:49.015 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 01:23:49.020 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 01:23:49.023 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 01:23:49.026 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 01:23:49.029 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 01:24:28.402 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 01:24:28.409 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 01:24:28.412 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 01:24:28.441 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 01:24:28.444 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 01:24:28.447 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 01:24:28.450 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 01:24:28.453 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 01:24:28.456 +04:00 [DBG] Error Url: /home/error
2023-07-16 01:24:28.458 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 01:24:28.487 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 01:24:28.511 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 01:24:28.515 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 01:24:28.524 +04:00 [DBG] Start discovery request
2023-07-16 01:24:28.880 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:29.206 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:29.241 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:29.649 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 01:24:30.537 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:24:30.563 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:24:30.565 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:24:30.572 +04:00 [DBG] Start authorize request
2023-07-16 01:24:30.606 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:24:30.635 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:31.178 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:31.190 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:31.214 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:31.337 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:31.364 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:31.399 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:31.439 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:31.457 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 01:24:31.488 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:31.515 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:31.554 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"544b51cb5d8a4324a5d315649bb9dd67","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"544b51cb5d8a4324a5d315649bb9dd67","code_challenge":"YTzMH8SumpMNDispwVe5TEngEWd8OZ-Ib80s-8uc-04","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:24:31.606 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:24:31.613 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:24:31.618 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:24:31.622 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 01:24:32.229 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:32.286 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:32.289 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:32.294 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:32.304 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:32.315 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:32.322 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:32.329 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:36.806 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:24:36.811 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:24:36.815 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:24:36.818 +04:00 [DBG] Start authorize request
2023-07-16 01:24:36.835 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:24:36.855 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:36.967 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:36.970 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:36.975 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:36.985 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:36.994 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:37.003 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:37.008 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:37.012 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"70c21f18b06c4caa937194ce2cf65185","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"70c21f18b06c4caa937194ce2cf65185","code_challenge":"pqRfTPySo62aIA0ypFWd5_gx1SuVPd8kqlMtjMyiPek","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:24:37.038 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:24:37.041 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:24:37.044 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:24:37.047 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 01:24:37.223 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:37.318 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:37.321 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:37.326 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:37.338 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:37.371 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:37.380 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:37.383 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:54.972 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:55.069 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:55.071 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:55.074 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:55.087 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:55.107 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:55.118 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:55.124 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:55.168 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:55.230 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:55.239 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:55.242 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:55.257 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:55.266 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:55.279 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:55.282 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:55.316 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 01:24:55.325 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 01:24:55.331 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 01:24:55.344 +04:00 [DBG] Start authorize callback request
2023-07-16 01:24:55.353 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:24:55.356 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:55.469 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:55.487 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:55.491 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:55.499 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:55.508 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:55.516 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:55.519 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:55.522 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"70c21f18b06c4caa937194ce2cf65185","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"70c21f18b06c4caa937194ce2cf65185","code_challenge":"pqRfTPySo62aIA0ypFWd5_gx1SuVPd8kqlMtjMyiPek","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:24:55.546 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:24:55.548 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:24:55.551 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:24:55.557 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 01:24:55.563 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"70c21f18b06c4caa937194ce2cf65185","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"70c21f18b06c4caa937194ce2cf65185","code_challenge":"pqRfTPySo62aIA0ypFWd5_gx1SuVPd8kqlMtjMyiPek","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:24:56.959 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 01:24:56.978 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 01:24:56.983 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 01:24:57.040 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 01:24:57.048 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 01:24:57.052 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 01:24:57.063 +04:00 [DBG] Start discovery request
2023-07-16 01:24:57.187 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 01:24:57.279 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:24:57.295 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:24:57.299 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:24:57.302 +04:00 [DBG] Start authorize request
2023-07-16 01:24:57.306 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:24:57.311 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:24:57.450 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:24:57.454 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:24:57.460 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:24:57.471 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:24:57.481 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:24:57.492 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:24:57.497 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:24:57.501 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"1286af9a7a464f4794ea23b8cb19aba1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"1286af9a7a464f4794ea23b8cb19aba1","code_challenge":"pJj4CaUVFk0XQp8CpNmZnocL66eLZmGBravpKnNshQc","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:24:57.539 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:24:57.545 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:24:57.557 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:24:57.567 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 01:24:57.600 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"1286af9a7a464f4794ea23b8cb19aba1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"1286af9a7a464f4794ea23b8cb19aba1","code_challenge":"pJj4CaUVFk0XQp8CpNmZnocL66eLZmGBravpKnNshQc","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:26:02.276 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:26:02.279 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:26:02.286 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:26:02.291 +04:00 [DBG] Start authorize request
2023-07-16 01:26:02.294 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:26:02.299 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:26:02.446 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:26:02.451 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:26:02.455 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:26:02.473 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:26:02.509 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:26:02.525 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:26:02.528 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:26:02.537 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f90744a7229e4fc28907d259fe6a21c5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f90744a7229e4fc28907d259fe6a21c5","code_challenge":"UBj7nSc8nc2KMqujFJRw8T_p4KHMIbMVTFzqMiFXlfU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:26:02.574 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:26:02.577 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:26:02.581 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:26:02.585 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 01:26:02.779 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:26:02.885 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:26:02.889 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:26:02.893 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:26:02.950 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:26:03.008 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:26:03.073 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:26:03.079 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:28.105 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:28.190 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:28.194 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:28.197 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:28.211 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:28.237 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:28.251 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:28.256 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:28.275 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:28.357 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:28.360 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:28.366 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:28.379 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:28.391 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:28.399 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:28.406 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:28.452 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 01:30:28.456 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 01:30:28.459 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 01:30:28.463 +04:00 [DBG] Start authorize callback request
2023-07-16 01:30:28.472 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:30:28.477 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:28.596 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:28.601 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:28.605 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:28.614 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:28.624 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:28.636 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:28.640 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:28.643 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f90744a7229e4fc28907d259fe6a21c5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f90744a7229e4fc28907d259fe6a21c5","code_challenge":"UBj7nSc8nc2KMqujFJRw8T_p4KHMIbMVTFzqMiFXlfU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:28.675 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:30:28.678 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:30:28.680 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:30:28.686 +04:00 [INF] Error: User consent result: "AccessDenied"
2023-07-16 01:30:28.691 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f90744a7229e4fc28907d259fe6a21c5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f90744a7229e4fc28907d259fe6a21c5","code_challenge":"UBj7nSc8nc2KMqujFJRw8T_p4KHMIbMVTFzqMiFXlfU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:29.979 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 01:30:29.982 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 01:30:29.987 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 01:30:29.994 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 01:30:30.000 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 01:30:30.003 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 01:30:30.020 +04:00 [DBG] Start discovery request
2023-07-16 01:30:30.106 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 01:30:30.173 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:30:30.177 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:30:30.181 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:30:30.185 +04:00 [DBG] Start authorize request
2023-07-16 01:30:30.189 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:30:30.192 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:30.322 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:30.326 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:30.340 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:30.353 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:30.369 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:30.388 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:30.391 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:30.396 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9ac8bb77c98d4a998b6d9385201afb8c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"9ac8bb77c98d4a998b6d9385201afb8c","code_challenge":"H5iBZqm593BsRllzdTL13hR3mpFtO4FHZOopL0J8ugY","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:30.445 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:30:30.453 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:30:30.457 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:30:30.461 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 01:30:30.466 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9ac8bb77c98d4a998b6d9385201afb8c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"9ac8bb77c98d4a998b6d9385201afb8c","code_challenge":"H5iBZqm593BsRllzdTL13hR3mpFtO4FHZOopL0J8ugY","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:38.909 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:30:38.915 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:30:38.919 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:30:38.922 +04:00 [DBG] Start authorize request
2023-07-16 01:30:38.927 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:30:38.932 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:39.137 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:39.140 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:39.143 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:39.156 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:39.167 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:39.176 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:39.182 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:39.187 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9940960860234d71ab1f1b07bff9a183","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"9940960860234d71ab1f1b07bff9a183","code_challenge":"PCOT4t-CIVZZxwPQMO4J27-YF2sLsfuSvW7EtTKoMaE","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:39.221 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:30:39.224 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:30:39.228 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:30:39.232 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 01:30:39.342 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:39.435 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:39.438 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:39.441 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:39.451 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:39.460 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:39.472 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:39.476 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:54.039 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:54.109 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:54.112 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:54.117 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:54.128 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:54.139 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:54.150 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:54.153 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:54.156 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:54.222 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:54.228 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:54.231 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:54.241 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:54.251 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:54.264 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:54.267 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:54.303 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 01:30:54.313 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 01:30:54.318 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 01:30:54.321 +04:00 [DBG] Start authorize callback request
2023-07-16 01:30:54.326 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:30:54.329 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:54.405 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:54.410 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:54.416 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:54.433 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:54.450 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:54.464 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:54.468 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:54.472 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9940960860234d71ab1f1b07bff9a183","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"9940960860234d71ab1f1b07bff9a183","code_challenge":"PCOT4t-CIVZZxwPQMO4J27-YF2sLsfuSvW7EtTKoMaE","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:54.505 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:30:54.511 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:30:54.518 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:30:54.521 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 01:30:54.527 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9940960860234d71ab1f1b07bff9a183","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"9940960860234d71ab1f1b07bff9a183","code_challenge":"PCOT4t-CIVZZxwPQMO4J27-YF2sLsfuSvW7EtTKoMaE","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:55.612 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 01:30:55.618 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 01:30:55.622 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 01:30:55.637 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 01:30:55.656 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 01:30:55.680 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 01:30:55.686 +04:00 [DBG] Start discovery request
2023-07-16 01:30:55.744 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 01:30:55.798 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 01:30:55.802 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 01:30:55.807 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 01:30:55.815 +04:00 [DBG] Start authorize request
2023-07-16 01:30:55.819 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 01:30:55.826 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 01:30:55.897 +04:00 [DBG] insig_spa found in database: true
2023-07-16 01:30:55.900 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 01:30:55.904 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 01:30:55.914 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 01:30:55.926 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 01:30:55.959 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 01:30:55.963 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 01:30:55.967 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"353820d5baf74d3884d1ca0b37bd9906","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"353820d5baf74d3884d1ca0b37bd9906","code_challenge":"pPi_073wVLee6rbdsg7u0C1-jMG13BACVSAwgxzgWSs","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 01:30:55.997 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 01:30:56.001 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 01:30:56.004 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 01:30:56.007 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 01:30:56.030 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"353820d5baf74d3884d1ca0b37bd9906","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"353820d5baf74d3884d1ca0b37bd9906","code_challenge":"pPi_073wVLee6rbdsg7u0C1-jMG13BACVSAwgxzgWSs","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:18:53.048 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 13:18:53.117 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 13:18:53.121 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 13:18:53.123 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 13:18:53.126 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 13:18:53.129 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 13:18:53.131 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 13:18:53.147 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 13:18:53.152 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 13:18:53.155 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 13:18:53.158 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 13:18:53.161 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 13:18:53.163 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 13:18:53.166 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 13:20:40.550 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 13:20:40.563 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 13:20:40.567 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 13:20:40.570 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 13:20:40.574 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 13:20:40.577 +04:00 [DBG] Error Url: /home/error
2023-07-16 13:20:40.580 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 13:20:41.787 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 13:20:41.800 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 13:20:41.803 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 13:20:41.813 +04:00 [DBG] Start discovery request
2023-07-16 13:20:42.015 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:42.160 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:42.232 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:42.736 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 13:20:55.696 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 13:20:55.703 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 13:20:55.706 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 13:20:55.722 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 13:20:55.726 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 13:20:55.736 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 13:20:55.740 +04:00 [DBG] Start discovery request
2023-07-16 13:20:55.789 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 13:20:55.886 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 13:20:56.232 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 13:20:56.235 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 13:20:56.249 +04:00 [DBG] Start authorize request
2023-07-16 13:20:56.303 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 13:20:56.523 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:20:57.241 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:20:57.259 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:20:57.288 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:20:57.428 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:57.460 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:20:57.503 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:57.567 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:20:57.586 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 13:20:57.607 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:20:57.638 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:20:57.677 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d9f377634a884f589654269902203b09","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d9f377634a884f589654269902203b09","code_challenge":"kILxSI73LF4GX6zq4Ki0Lalm7y80x0ykIeF4E3qsYtE","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:20:57.770 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 13:20:57.776 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 13:20:57.780 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 13:20:57.785 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 13:20:57.792 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d9f377634a884f589654269902203b09","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d9f377634a884f589654269902203b09","code_challenge":"kILxSI73LF4GX6zq4Ki0Lalm7y80x0ykIeF4E3qsYtE","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:21:00.098 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 13:21:00.104 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 13:21:00.107 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 13:21:00.111 +04:00 [DBG] Start authorize request
2023-07-16 13:21:00.114 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 13:21:00.121 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:21:00.235 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:21:00.239 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:21:00.242 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:21:00.253 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:21:00.262 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:21:00.274 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:21:00.278 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:21:00.286 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c40138f8d5ab41aebae278bf500260bf","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"c40138f8d5ab41aebae278bf500260bf","code_challenge":"RMBqSFdz48zlpEhg5m9HWNP_staxNYqAWRUWR3KDfCQ","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:21:00.316 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 13:21:00.321 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 13:21:00.324 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 13:21:00.327 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 13:21:00.761 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:21:00.902 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:21:00.906 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:21:00.909 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:21:00.919 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:21:00.928 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:21:00.940 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:21:00.943 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:21:33.222 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:21:33.299 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:21:33.303 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:21:33.307 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:21:33.318 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:21:33.327 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:21:33.337 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:21:33.341 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:21:59.808 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:21:59.967 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:21:59.969 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:21:59.972 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:21:59.985 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:22:00.054 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:22:00.072 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:22:00.076 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:26:05.749 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:26:05.843 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:26:05.846 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:26:05.848 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:26:05.860 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:26:05.882 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:26:05.896 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:26:05.899 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:26:05.968 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 13:26:05.975 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 13:26:05.990 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 13:26:06.006 +04:00 [DBG] Start authorize callback request
2023-07-16 13:26:06.016 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 13:26:06.020 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:26:06.091 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:26:06.094 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:26:06.097 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:26:06.107 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:26:06.116 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:26:06.125 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:26:06.128 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:26:06.131 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c40138f8d5ab41aebae278bf500260bf","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"c40138f8d5ab41aebae278bf500260bf","code_challenge":"RMBqSFdz48zlpEhg5m9HWNP_staxNYqAWRUWR3KDfCQ","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:26:06.147 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 13:26:06.151 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 13:26:06.156 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 13:26:06.166 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 13:26:06.172 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c40138f8d5ab41aebae278bf500260bf","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"c40138f8d5ab41aebae278bf500260bf","code_challenge":"RMBqSFdz48zlpEhg5m9HWNP_staxNYqAWRUWR3KDfCQ","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:26:07.607 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 13:26:07.611 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 13:26:07.644 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 13:26:07.661 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 13:26:07.672 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 13:26:07.676 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 13:26:07.680 +04:00 [DBG] Start discovery request
2023-07-16 13:26:07.881 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 13:26:07.988 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 13:26:08.005 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 13:26:08.016 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 13:26:08.030 +04:00 [DBG] Start authorize request
2023-07-16 13:26:08.046 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 13:26:08.056 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:26:08.134 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:26:08.141 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:26:08.153 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:26:08.180 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:26:08.202 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:26:08.223 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:26:08.235 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:26:08.241 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d0e9d6e5292e4f2fb67ed241a278418a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d0e9d6e5292e4f2fb67ed241a278418a","code_challenge":"nYey3UVgfbgzR7h_rPcEhksRUhyjjPW-S-Hm6beQdNk","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:26:08.313 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 13:26:08.317 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 13:26:08.323 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 13:26:08.329 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 13:26:08.341 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"d0e9d6e5292e4f2fb67ed241a278418a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"d0e9d6e5292e4f2fb67ed241a278418a","code_challenge":"nYey3UVgfbgzR7h_rPcEhksRUhyjjPW-S-Hm6beQdNk","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:39:05.909 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 13:39:05.917 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 13:39:05.921 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 13:39:05.925 +04:00 [DBG] Start authorize request
2023-07-16 13:39:05.935 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 13:39:05.938 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:39:06.056 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:39:06.062 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:39:06.066 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:39:06.084 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:39:06.125 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:39:06.143 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:39:06.147 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:39:06.152 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2a1b52e77f2e44568eb06f36cb6ab89d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2a1b52e77f2e44568eb06f36cb6ab89d","code_challenge":"L2bw86MXP55e9lIoyhVQEEt3HH7BK9QsMjKMKe08amo","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 13:39:06.186 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 13:39:06.189 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 13:39:06.193 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 13:39:06.201 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 13:39:21.306 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:39:21.441 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:39:21.443 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:39:21.447 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:39:21.455 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:39:21.464 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:39:21.473 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:39:21.477 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:40:27.143 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 13:40:27.228 +04:00 [DBG] insig_spa found in database: true
2023-07-16 13:40:27.231 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 13:40:27.234 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 13:40:27.246 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 13:40:27.266 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 13:40:27.278 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 13:40:27.281 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 13:41:56.872 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 13:41:56.930 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 13:41:56.933 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 13:41:56.935 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 13:41:56.938 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 13:41:56.941 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 13:41:56.944 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 13:41:56.956 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 13:41:56.962 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 13:41:56.964 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 13:41:56.967 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 13:41:56.969 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 13:41:56.971 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 13:41:56.975 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:02:49.453 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:02:49.496 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:02:49.499 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:02:49.502 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:02:49.504 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:02:49.507 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:02:49.509 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:02:49.524 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:02:49.528 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:02:49.531 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:02:49.535 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:02:49.538 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:02:49.541 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:02:49.544 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:02:50.779 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 14:02:50.786 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 14:02:50.790 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 14:02:50.793 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 14:02:50.796 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 14:02:50.802 +04:00 [DBG] Error Url: /home/error
2023-07-16 14:02:50.807 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 14:02:52.619 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:02:53.668 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:02:53.697 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:02:53.726 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:02:53.990 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:02:54.041 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:02:54.145 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:02:54.263 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:02:54.288 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:02:54.320 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:02:54.423 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:03:09.888 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:03:09.972 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:03:09.974 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:03:09.980 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:03:09.989 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:03:09.998 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:03:10.007 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:03:10.012 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:03:22.499 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:03:22.551 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:03:22.554 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:03:22.558 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:03:22.567 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:03:22.575 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:03:22.582 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:03:22.585 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:03:22.654 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 14:03:22.664 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 14:03:22.667 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 14:03:22.678 +04:00 [DBG] Start authorize callback request
2023-07-16 14:03:22.697 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:03:22.699 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:03:22.786 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:03:22.789 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:03:22.792 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:03:22.801 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:03:22.810 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:03:22.817 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:03:22.820 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:03:22.852 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2a1b52e77f2e44568eb06f36cb6ab89d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2a1b52e77f2e44568eb06f36cb6ab89d","code_challenge":"L2bw86MXP55e9lIoyhVQEEt3HH7BK9QsMjKMKe08amo","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:03:22.921 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:03:22.926 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:03:22.931 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:03:22.945 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 14:03:22.954 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2a1b52e77f2e44568eb06f36cb6ab89d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2a1b52e77f2e44568eb06f36cb6ab89d","code_challenge":"L2bw86MXP55e9lIoyhVQEEt3HH7BK9QsMjKMKe08amo","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:03:24.338 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 14:03:24.351 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 14:03:24.356 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 14:03:24.367 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 14:03:24.374 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 14:03:24.377 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 14:03:24.384 +04:00 [DBG] Start discovery request
2023-07-16 14:03:24.449 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:03:24.682 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:03:24.728 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:03:24.749 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 14:03:24.881 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:03:24.887 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:03:24.896 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:03:24.924 +04:00 [DBG] Start authorize request
2023-07-16 14:03:24.931 +04:00 [DBG] No user present in authorize request
2023-07-16 14:03:24.936 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:03:25.045 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:03:25.050 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:03:25.061 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:03:25.080 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:03:25.098 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:03:25.121 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:03:25.126 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:03:25.130 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a9d56bd0a57c4ef0a791e2f891f28482","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a9d56bd0a57c4ef0a791e2f891f28482","code_challenge":"atl_oMkx3oZbR2dVhqfFD8UZpM3MN1k5rohkEkQMSLA","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:03:25.134 +04:00 [INF] Showing login: User is not authenticated
2023-07-16 14:03:25.137 +04:00 [INF] Changing response to LoginRequired: prompt=none was requested
2023-07-16 14:03:25.142 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"a9d56bd0a57c4ef0a791e2f891f28482","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"a9d56bd0a57c4ef0a791e2f891f28482","code_challenge":"atl_oMkx3oZbR2dVhqfFD8UZpM3MN1k5rohkEkQMSLA","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:07:39.015 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:07:39.072 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:07:39.075 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:07:39.078 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:07:39.081 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:07:39.083 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:07:39.085 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:07:39.098 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:07:39.103 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:07:39.105 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:07:39.108 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:07:39.110 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:07:39.113 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:07:39.115 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:07:41.815 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 14:07:41.820 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 14:07:41.823 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 14:07:41.825 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 14:07:41.830 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 14:07:41.833 +04:00 [DBG] Error Url: /home/error
2023-07-16 14:07:41.836 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 14:07:43.033 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:07:43.058 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:07:43.062 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:07:43.069 +04:00 [DBG] Start authorize request
2023-07-16 14:07:43.100 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:07:43.120 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:07:44.263 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:07:44.282 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:07:44.305 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:07:44.527 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:07:44.584 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:07:44.720 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:07:44.848 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:07:44.872 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:07:44.898 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:07:44.964 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:07:45.001 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"9f1b92128c134a7dad22d0b7823e1c4f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"9f1b92128c134a7dad22d0b7823e1c4f","code_challenge":"eB-q1ldEiWBYwAIlaL6MmYCo6WDSgp3Cl7RJ--F2HMo","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:07:45.080 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:07:45.088 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:07:45.095 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:07:45.100 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 14:07:45.605 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:07:45.671 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:07:45.677 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:07:45.681 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:07:45.714 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:07:45.756 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:07:45.768 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:07:45.772 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:07:55.381 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:07:55.597 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:07:55.600 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:07:55.603 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:07:55.615 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:07:55.627 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:07:55.641 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:07:55.645 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:08:07.064 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 14:08:07.073 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 14:08:07.077 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 14:08:07.094 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 14:08:07.100 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 14:08:07.105 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 14:08:07.125 +04:00 [DBG] Start discovery request
2023-07-16 14:08:07.206 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:08:07.365 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:08:07.403 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:08:07.425 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 14:08:07.577 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:08:07.594 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:08:07.597 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:08:07.602 +04:00 [DBG] Start authorize request
2023-07-16 14:08:07.606 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:08:07.611 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:08:07.766 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:08:07.773 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:08:07.777 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:08:07.797 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:08:07.819 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:08:07.835 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:08:07.839 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:08:07.844 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5ef7f268356d4318a0ce90fe70187aa7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5ef7f268356d4318a0ce90fe70187aa7","code_challenge":"d3WCNwlfVYRHHtV0258qGymWrJ0zaTkS9A4q9oNpwRQ","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:08:07.891 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:08:07.895 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:08:07.899 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:08:07.902 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 14:08:07.911 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"5ef7f268356d4318a0ce90fe70187aa7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"5ef7f268356d4318a0ce90fe70187aa7","code_challenge":"d3WCNwlfVYRHHtV0258qGymWrJ0zaTkS9A4q9oNpwRQ","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:08:11.345 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:08:11.360 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:08:11.364 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:08:11.372 +04:00 [DBG] Start authorize request
2023-07-16 14:08:11.376 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:08:11.379 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:08:11.492 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:08:11.506 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:08:11.510 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:08:11.521 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:08:11.529 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:08:11.540 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:08:11.543 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:08:11.547 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f38866f498c6456cb3c474a312089063","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f38866f498c6456cb3c474a312089063","code_challenge":"7jE_OaFNb68y9eZB-CNAAVLRVVGfm_Sgcy67k7D2raM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:08:11.575 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:08:11.578 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:08:11.582 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:08:11.588 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 14:08:11.737 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:08:11.817 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:08:11.820 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:08:11.873 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:08:11.916 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:08:11.933 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:08:11.946 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:08:11.951 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:08:44.524 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:08:44.590 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:08:44.594 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:08:44.597 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:08:44.613 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:08:44.622 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:08:44.634 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:08:44.638 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:12:44.204 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:12:44.336 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:12:44.339 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:12:44.341 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:12:44.354 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:12:44.388 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:12:44.399 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:12:44.403 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:13:42.567 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 14:13:42.571 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 14:13:42.574 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 14:13:42.587 +04:00 [DBG] Start authorize callback request
2023-07-16 14:13:42.595 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:13:42.599 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:13:42.742 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:13:42.745 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:13:42.748 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:13:42.762 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:13:42.782 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:13:42.795 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:13:42.799 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:13:42.802 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f38866f498c6456cb3c474a312089063","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f38866f498c6456cb3c474a312089063","code_challenge":"7jE_OaFNb68y9eZB-CNAAVLRVVGfm_Sgcy67k7D2raM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:13:42.816 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:13:42.819 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:13:42.822 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:13:42.827 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 14:13:42.835 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"f38866f498c6456cb3c474a312089063","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"f38866f498c6456cb3c474a312089063","code_challenge":"7jE_OaFNb68y9eZB-CNAAVLRVVGfm_Sgcy67k7D2raM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:13:44.285 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 14:13:44.288 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 14:13:44.291 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 14:13:44.301 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 14:13:44.304 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 14:13:44.308 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 14:13:44.311 +04:00 [DBG] Start discovery request
2023-07-16 14:13:44.359 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 14:13:44.419 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:13:44.434 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:13:44.453 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:13:44.478 +04:00 [DBG] Start authorize request
2023-07-16 14:13:44.519 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:13:44.526 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:13:44.671 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:13:44.674 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:13:44.689 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:13:44.717 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:13:44.750 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:13:44.759 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:13:44.770 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:13:44.782 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"364112165d794847ab1434fb0188a5c3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"364112165d794847ab1434fb0188a5c3","code_challenge":"aeJm6w4a31T63lZ3n6H4pGv_NUOuxBI-i-7thJjqrrw","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:13:44.810 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:13:44.813 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:13:44.817 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:13:44.820 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 14:13:44.823 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"364112165d794847ab1434fb0188a5c3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"364112165d794847ab1434fb0188a5c3","code_challenge":"aeJm6w4a31T63lZ3n6H4pGv_NUOuxBI-i-7thJjqrrw","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:30:19.360 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:30:19.399 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:30:19.402 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:30:19.405 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:30:19.408 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:30:19.411 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:30:19.413 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:30:19.427 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:30:19.432 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:30:19.435 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:30:19.439 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:30:19.442 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:30:19.446 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:30:19.454 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:30:28.565 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 14:30:28.572 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 14:30:28.575 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 14:30:28.577 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 14:30:28.580 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 14:30:28.582 +04:00 [DBG] Error Url: /home/error
2023-07-16 14:30:28.586 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 14:30:29.573 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:30:29.609 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:30:29.613 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:30:29.625 +04:00 [DBG] Start authorize request
2023-07-16 14:30:29.657 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:30:29.678 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:30:30.609 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:30:30.625 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:30:30.659 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:30:30.812 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:30:30.858 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:30:30.941 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:30:31.030 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:30:31.056 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:30:31.087 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:30:31.148 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:30:31.186 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"c391a79673e7499c95eb43ed520e3a85","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"c391a79673e7499c95eb43ed520e3a85","code_challenge":"vSMs29MP06_BvHZKT3EKupKSM7Uz7Kwjm4Q_pUxJTIM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:30:31.246 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:30:31.252 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:30:31.256 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:30:31.261 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 14:30:31.815 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:30:31.885 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:30:31.888 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:30:31.891 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:30:31.900 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:30:31.910 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:30:31.920 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:30:31.924 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:30:44.160 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:30:44.254 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:30:44.257 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:30:44.261 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:30:44.273 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:30:44.286 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:30:44.294 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:30:44.299 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:30:50.109 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 14:47:18.724 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:47:18.794 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:47:18.796 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:47:18.799 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:47:18.802 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:47:18.806 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:47:18.810 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:47:18.827 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 14:47:18.832 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 14:47:18.836 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 14:47:18.838 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 14:47:18.842 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 14:47:18.847 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 14:47:18.855 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 14:47:31.140 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 14:47:31.147 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 14:47:31.151 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 14:47:31.185 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 14:47:31.187 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 14:47:31.190 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 14:47:31.192 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 14:47:31.195 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 14:47:31.198 +04:00 [DBG] Error Url: /home/error
2023-07-16 14:47:31.201 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 14:47:31.238 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 14:47:31.269 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 14:47:31.273 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 14:47:31.281 +04:00 [DBG] Start discovery request
2023-07-16 14:47:31.695 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:32.192 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:32.251 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:32.739 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 14:47:33.495 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:47:33.521 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:47:33.524 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:47:33.531 +04:00 [DBG] Start authorize request
2023-07-16 14:47:33.560 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:47:33.578 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:47:34.091 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:47:34.108 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:47:34.134 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:47:34.232 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:34.270 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:47:34.312 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:34.353 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:47:34.371 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 14:47:34.391 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:47:34.413 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:47:34.460 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2074aa26988741cba84463a04f5c69ec","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2074aa26988741cba84463a04f5c69ec","code_challenge":"L-HiiFkJ_88GgOORdpjgpOBhuizQt1cmEiB0vuPUqNA","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:47:34.527 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:47:34.535 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:47:34.539 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:47:34.561 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 14:47:35.005 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:47:35.068 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:47:35.071 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:47:35.074 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:47:35.088 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:47:35.103 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:47:35.121 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:47:35.125 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:47:56.063 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:47:56.133 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:47:56.137 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:47:56.141 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:47:56.151 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:47:56.161 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:47:56.169 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:47:56.172 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:48:03.046 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 14:48:14.922 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 14:49:23.305 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:49:23.410 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:49:23.413 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:49:23.418 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:49:23.429 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:49:23.450 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:49:23.461 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:49:23.464 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:49:23.544 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 14:49:23.549 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 14:49:23.554 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 14:49:23.563 +04:00 [DBG] Start authorize callback request
2023-07-16 14:49:23.572 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:49:23.575 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:49:23.629 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:49:23.633 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:49:23.636 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:49:23.645 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:49:23.655 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:49:23.663 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:49:23.669 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:49:23.674 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2074aa26988741cba84463a04f5c69ec","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2074aa26988741cba84463a04f5c69ec","code_challenge":"L-HiiFkJ_88GgOORdpjgpOBhuizQt1cmEiB0vuPUqNA","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:49:23.687 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:49:23.690 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:49:23.695 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:49:23.705 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 14:49:23.712 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2074aa26988741cba84463a04f5c69ec","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2074aa26988741cba84463a04f5c69ec","code_challenge":"L-HiiFkJ_88GgOORdpjgpOBhuizQt1cmEiB0vuPUqNA","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:49:25.141 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 14:49:25.144 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 14:49:25.149 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 14:49:25.156 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 14:49:25.159 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 14:49:25.162 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 14:49:25.169 +04:00 [DBG] Start discovery request
2023-07-16 14:49:25.283 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 14:49:25.617 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 14:49:25.622 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 14:49:25.624 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 14:49:25.628 +04:00 [DBG] Start authorize request
2023-07-16 14:49:25.632 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 14:49:25.634 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 14:49:25.702 +04:00 [DBG] insig_spa found in database: true
2023-07-16 14:49:25.706 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 14:49:25.710 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 14:49:25.723 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 14:49:25.776 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 14:49:25.792 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 14:49:25.798 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 14:49:25.806 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"102af9a6ec424b14bc58abb47f12dcdf","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"102af9a6ec424b14bc58abb47f12dcdf","code_challenge":"z1ACNlDbYwMP7Bp5NCqRbCK_18p5gYlukRiA2wVIP5k","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 14:49:26.061 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 14:49:26.067 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 14:49:26.071 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 14:49:26.075 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 14:49:26.080 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"102af9a6ec424b14bc58abb47f12dcdf","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"102af9a6ec424b14bc58abb47f12dcdf","code_challenge":"z1ACNlDbYwMP7Bp5NCqRbCK_18p5gYlukRiA2wVIP5k","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:16:41.561 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 15:16:41.601 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 15:16:41.604 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 15:16:41.607 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 15:16:41.609 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 15:16:41.612 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 15:16:41.614 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 15:16:41.626 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 15:16:41.631 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 15:16:41.633 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 15:16:41.636 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 15:16:41.638 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 15:16:41.641 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 15:16:41.644 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 15:17:16.127 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 15:17:16.133 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 15:17:16.136 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 15:17:16.169 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 15:17:16.172 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 15:17:16.175 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 15:17:16.177 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 15:17:16.180 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 15:17:16.183 +04:00 [DBG] Error Url: /home/error
2023-07-16 15:17:16.185 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 15:17:16.216 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 15:17:16.233 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 15:17:16.236 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 15:17:16.246 +04:00 [DBG] Start discovery request
2023-07-16 15:17:16.830 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:17.300 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:17.347 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:17.778 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 15:17:18.724 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 15:17:18.730 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 15:17:18.754 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 15:17:18.757 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 15:17:18.760 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 15:17:18.764 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 15:17:18.778 +04:00 [DBG] Start authorize request
2023-07-16 15:17:18.781 +04:00 [DBG] Start authorize request
2023-07-16 15:17:18.820 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 15:17:18.823 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 15:17:18.848 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:18.851 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:19.427 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:19.429 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:19.445 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:19.448 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:19.480 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:19.482 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:19.574 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:19.607 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:19.611 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:19.663 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:19.709 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:19.711 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:19.732 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:17:19.756 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:19.757 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:19.780 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:19.783 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:19.820 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"3331ce69855a48e88034a4135dba6027","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"3331ce69855a48e88034a4135dba6027","code_challenge":"k-tUxHD9CJy60Jyc3TIdiRkI1EX5hTpK6mWOXkA5I6k","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:17:19.820 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"cc3b1d03322c4555863f9c5f33a8e239","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"cc3b1d03322c4555863f9c5f33a8e239","code_challenge":"0WRS7jI1CNELS_XZDrwSexSeogS4_6Gme-6RQvW4LEk","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:17:19.903 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 15:17:19.905 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 15:17:19.913 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 15:17:19.916 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 15:17:19.919 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 15:17:19.921 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 15:17:19.927 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 15:17:19.930 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 15:17:20.377 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:20.439 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:20.443 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:20.446 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:20.460 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:20.486 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:20.499 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:20.503 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:34.542 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:34.608 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:34.611 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:34.613 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:34.623 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:34.657 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:34.665 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:34.668 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:38.391 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 15:17:39.660 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:39.728 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:39.732 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:39.735 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:39.757 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:39.768 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:39.779 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:39.783 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:46.998 +04:00 [ERR] The view 'Redirect' was not found. Searched locations: ["/Views/Consent/Redirect.cshtml","/Views/Shared/Redirect.cshtml","/Pages/Shared/Redirect.cshtml"]
2023-07-16 15:17:48.103 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Redirect' was not found. The following locations were searched:
/Views/Consent/Redirect.cshtml
/Views/Shared/Redirect.cshtml
/Pages/Shared/Redirect.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.CspMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Insig.Common.Configuration.ApplicationBuilderExtensions.<>c.<<RemoveServerHeader>b__0_0>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.Common\Configuration\ApplicationBuilderExtensions.cs:line 15
--- End of stack trace from previous location ---
   at Insig.IdentityServer.Startup.<>c.<<Configure>b__7_1>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Startup.cs:line 212
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2023-07-16 15:17:48.646 +04:00 [ERR] An exception was thrown attempting to execute the error handler.
System.InvalidOperationException: Invalid non-ASCII or control character in header: 0x000D
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.ThrowInvalidHeaderCharacter(Char ch)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.ValidateHeaderValueCharacters(String headerCharacters, Boolean requireAscii)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.ValidateHeaderValueCharacters(String headerName, StringValues headerValues, Func`2 encodingSelector)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseHeaders.AddValueFast(String key, StringValues value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.System.Collections.Generic.IDictionary<System.String,Microsoft.Extensions.Primitives.StringValues>.Add(String key, StringValues value)
   at Insig.IdentityServer.Extensions.HttpResponseExtensions.AddApplicationError(HttpResponse response, String message) in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Extensions\HttpResponseExtensions.cs:line 9
   at Insig.IdentityServer.Startup.<>c.<<Configure>b__7_4>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Startup.cs:line 192
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
2023-07-16 15:17:48.662 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Redirect' was not found. The following locations were searched:
/Views/Consent/Redirect.cshtml
/Views/Shared/Redirect.cshtml
/Pages/Shared/Redirect.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)
   at NWebsec.AspNetCore.Middleware.Middleware.CspMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Insig.Common.Configuration.ApplicationBuilderExtensions.<>c.<<RemoveServerHeader>b__0_0>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.Common\Configuration\ApplicationBuilderExtensions.cs:line 15
--- End of stack trace from previous location ---
   at Insig.IdentityServer.Startup.<>c.<<Configure>b__7_1>d.MoveNext() in D:\courses\signalR\angular_core\Insig\Insig.IdentityServer\Startup.cs:line 212
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2023-07-16 15:17:56.243 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:56.329 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:56.341 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:56.345 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:56.359 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:56.370 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:56.380 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:56.388 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:17:58.735 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:17:58.824 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:17:58.828 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:17:58.834 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:17:58.845 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:17:58.859 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:17:58.876 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:17:58.881 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:18:03.740 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 15:24:14.688 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 15:24:14.758 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 15:24:14.760 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 15:24:14.763 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 15:24:14.767 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 15:24:14.770 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 15:24:14.773 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 15:24:14.786 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 15:24:14.790 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 15:24:14.792 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 15:24:14.794 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 15:24:14.797 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 15:24:14.799 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 15:24:14.802 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 15:24:32.819 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 15:24:32.828 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 15:24:32.831 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 15:24:32.834 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 15:24:32.836 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 15:24:32.839 +04:00 [DBG] Error Url: /home/error
2023-07-16 15:24:32.845 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 15:24:34.421 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:24:35.477 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:24:35.493 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:24:35.517 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:24:35.705 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:35.758 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:24:35.858 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:35.958 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:24:35.982 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:36.011 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:24:36.088 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:24:38.412 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 15:24:38.420 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 15:24:38.430 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 15:24:38.499 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 15:24:38.529 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 15:24:38.534 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 15:24:38.544 +04:00 [DBG] Start discovery request
2023-07-16 15:24:38.657 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:38.843 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:38.992 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 15:24:39.024 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 15:24:39.229 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 15:24:39.237 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 15:24:39.242 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 15:24:39.257 +04:00 [DBG] Start authorize request
2023-07-16 15:24:39.283 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 15:24:39.295 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:24:39.547 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:24:39.551 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:24:39.554 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:24:39.564 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:24:39.574 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:24:39.582 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:24:39.587 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:24:39.641 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ab84366937da4ed7bed883888acfea6c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"ab84366937da4ed7bed883888acfea6c","code_challenge":"6J2hDn02bGaMyI6NhvwpCM7BATwvbsOPwdDz7N6iy58","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:24:39.724 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 15:24:39.761 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 15:24:39.768 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 15:24:39.777 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 15:24:39.789 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"ab84366937da4ed7bed883888acfea6c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"ab84366937da4ed7bed883888acfea6c","code_challenge":"6J2hDn02bGaMyI6NhvwpCM7BATwvbsOPwdDz7N6iy58","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:24:44.978 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 15:24:44.983 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 15:24:44.990 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 15:24:44.993 +04:00 [DBG] Start authorize request
2023-07-16 15:24:44.996 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 15:24:45.000 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:24:45.101 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:24:45.107 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:24:45.110 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:24:45.144 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:24:45.180 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:24:45.196 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:24:45.200 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:24:45.204 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"2d0b845fcd4c4cfaad46ccbe91cc0663","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"2d0b845fcd4c4cfaad46ccbe91cc0663","code_challenge":"a7Tpv_a_gWg0unftb63nqrsi_OyEgyvJ-81e9jw4MdQ","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 15:24:45.240 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 15:24:45.243 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 15:24:45.246 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 15:24:45.250 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 15:24:45.459 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:24:45.631 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:24:45.634 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:24:45.639 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:24:45.647 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:24:45.662 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:24:45.674 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:24:45.677 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:24:58.988 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 15:24:59.063 +04:00 [DBG] insig_spa found in database: true
2023-07-16 15:24:59.066 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 15:24:59.070 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 15:24:59.078 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 15:24:59.087 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 15:24:59.094 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 15:24:59.097 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 15:25:05.542 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 17:42:47.836 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 17:42:47.976 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 17:42:47.982 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 17:42:47.991 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 17:42:47.995 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 17:42:48.003 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 17:42:48.006 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 17:42:48.035 +04:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2023-07-16 17:42:48.041 +04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2023-07-16 17:42:48.044 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2023-07-16 17:42:48.047 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2023-07-16 17:42:48.050 +04:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2023-07-16 17:42:48.053 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2023-07-16 17:42:48.064 +04:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2023-07-16 17:42:56.286 +04:00 [DBG] Login Url: /Account/Login
2023-07-16 17:42:56.294 +04:00 [DBG] Login Return Url Parameter: ReturnUrl
2023-07-16 17:42:56.299 +04:00 [DBG] Logout Url: /Account/Logout
2023-07-16 17:42:56.304 +04:00 [DBG] ConsentUrl Url: /consent
2023-07-16 17:42:56.308 +04:00 [DBG] Consent Return Url Parameter: returnUrl
2023-07-16 17:42:56.313 +04:00 [DBG] Error Url: /home/error
2023-07-16 17:42:56.320 +04:00 [DBG] Error Id Parameter: errorId
2023-07-16 17:42:58.552 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 17:42:58.607 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 17:42:58.613 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 17:42:58.626 +04:00 [DBG] Start authorize request
2023-07-16 17:42:58.724 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 17:42:58.760 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:43:00.738 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:43:00.770 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:43:00.824 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:43:01.138 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:43:01.187 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:43:01.421 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:43:01.646 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:43:01.688 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:43:01.736 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:43:01.889 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:43:01.976 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"63e4ee24b0e74719946b840dd09dc950","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"4A823B9D65F03CDF89960583466F09EE","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"63e4ee24b0e74719946b840dd09dc950","code_challenge":"L2S-atr9m0VvDkhLYXqQlxcCZKzCtYDb2T_o4p_X110","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:43:02.116 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 17:43:02.125 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 17:43:02.134 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 17:43:02.141 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 17:43:03.183 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:43:03.286 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:43:03.295 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:43:03.311 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:43:03.349 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:43:03.367 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:43:03.382 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:43:03.392 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:44:47.251 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 17:44:47.264 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 17:44:47.306 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 17:44:47.336 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 17:44:47.349 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 17:44:47.393 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 17:44:47.403 +04:00 [DBG] Start discovery request
2023-07-16 17:44:47.552 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:44:47.869 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:44:48.053 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2023-07-16 17:44:48.149 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 17:44:48.468 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 17:44:48.472 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 17:44:48.475 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 17:44:48.480 +04:00 [DBG] Start authorize request
2023-07-16 17:44:48.483 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 17:44:48.486 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:44:48.757 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:44:48.770 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:44:48.778 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:44:48.844 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:44:48.881 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:44:48.906 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:44:48.914 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:44:48.920 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"bdeeee534b264ac7820d233063944e04","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"bdeeee534b264ac7820d233063944e04","code_challenge":"0DMtR65-eFCuqwtdmpvYsrM8yiRjFcVx0wKJqn79pM8","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:44:48.944 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 17:44:48.950 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 17:44:48.957 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 17:44:48.967 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 17:44:48.983 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"bdeeee534b264ac7820d233063944e04","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"bdeeee534b264ac7820d233063944e04","code_challenge":"0DMtR65-eFCuqwtdmpvYsrM8yiRjFcVx0wKJqn79pM8","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:44:51.867 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 17:44:51.891 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 17:44:51.905 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 17:44:51.915 +04:00 [DBG] Start authorize request
2023-07-16 17:44:51.920 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 17:44:51.940 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:44:52.132 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:44:52.138 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:44:52.146 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:44:52.161 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:44:52.175 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:44:52.200 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:44:52.204 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:44:52.210 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b32d5a6397dc4bde8293c9c5d2084379","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"b32d5a6397dc4bde8293c9c5d2084379","code_challenge":"Ez391250UhGzoVsaBDtekUOOpNYW_D4jAKllsABHqEM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:44:52.284 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 17:44:52.295 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 17:44:52.303 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 17:44:52.309 +04:00 [INF] Showing consent: User has not yet consented
2023-07-16 17:44:52.545 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:44:52.719 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:44:52.732 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:44:52.736 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:44:52.750 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:44:52.764 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:44:52.775 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:44:52.778 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:44:58.479 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:44:58.725 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:44:58.730 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:44:58.738 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:44:58.752 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:44:58.763 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:44:58.776 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:44:58.783 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:45:02.619 +04:00 [DBG] 0 persisted grants found for {"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","SessionId":null,"ClientId":null,"Type":null,"$type":"PersistedGrantFilter"}
2023-07-16 17:45:02.747 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:45:02.836 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:45:02.842 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:45:02.852 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:45:02.868 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:45:02.885 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:45:02.900 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:45:02.913 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:45:04.867 +04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2023-07-16 17:45:04.873 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2023-07-16 17:45:04.877 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2023-07-16 17:45:04.900 +04:00 [DBG] Start authorize callback request
2023-07-16 17:45:04.926 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 17:45:04.930 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:45:05.058 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:45:05.062 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:45:05.067 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:45:05.079 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:45:05.098 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:45:05.110 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:45:05.114 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:45:05.118 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b32d5a6397dc4bde8293c9c5d2084379","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"b32d5a6397dc4bde8293c9c5d2084379","code_challenge":"Ez391250UhGzoVsaBDtekUOOpNYW_D4jAKllsABHqEM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:45:05.150 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 17:45:05.154 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 17:45:05.160 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 17:45:05.167 +04:00 [INF] Error: User denied consent to required scopes
2023-07-16 17:45:05.171 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"b32d5a6397dc4bde8293c9c5d2084379","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"code","scope":"openid profile email insigapi.read","state":"b32d5a6397dc4bde8293c9c5d2084379","code_challenge":"Ez391250UhGzoVsaBDtekUOOpNYW_D4jAKllsABHqEM","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:45:07.849 +04:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2023-07-16 17:45:07.854 +04:00 [DBG] AllowedOrigins configured and origin http://localhost:4200 is allowed
2023-07-16 17:45:07.862 +04:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2023-07-16 17:45:07.870 +04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2023-07-16 17:45:07.877 +04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2023-07-16 17:45:07.881 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2023-07-16 17:45:07.893 +04:00 [DBG] Start discovery request
2023-07-16 17:45:07.927 +04:00 [DBG] Found ["openid","email","profile","insigapi.read"] as all scopes, and ["insigapi"] as API resources
2023-07-16 17:45:08.004 +04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2023-07-16 17:45:08.016 +04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2023-07-16 17:45:08.030 +04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2023-07-16 17:45:08.042 +04:00 [DBG] Start authorize request
2023-07-16 17:45:08.047 +04:00 [DBG] User in authorize request: 8a54875e-e7b9-4744-8684-3096f46d8fbd
2023-07-16 17:45:08.052 +04:00 [DBG] Start authorize request protocol validation
2023-07-16 17:45:08.242 +04:00 [DBG] insig_spa found in database: true
2023-07-16 17:45:08.253 +04:00 [DBG] client configuration validation for client insig_spa succeeded.
2023-07-16 17:45:08.285 +04:00 [DBG] Checking for PKCE parameters
2023-07-16 17:45:08.303 +04:00 [DBG] Found ["openid","email","profile"] identity scopes in database
2023-07-16 17:45:08.331 +04:00 [DBG] Found ["insigapi"] API resources in database
2023-07-16 17:45:08.369 +04:00 [DBG] Found ["insigapi.read"] scopes in database
2023-07-16 17:45:08.375 +04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2023-07-16 17:45:08.381 +04:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e0164425bb1242129dd984149bd486ca","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"e0164425bb1242129dd984149bd486ca","code_challenge":"VorSClDAzd3lgUgvIi_kQcGKSAziUM-hKY75CgQXXeI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-16 17:45:08.412 +04:00 [DBG] BKk3eslGoeItdhB1Q55V0VragY/UUvoRc9jJCIJmeUM= found in database: false
2023-07-16 17:45:08.417 +04:00 [DBG] user_consent grant with value: insig_spa|8a54875e-e7b9-4744-8684-3096f46d8fbd not found in store.
2023-07-16 17:45:08.459 +04:00 [DBG] Found no prior consent from consent store, consent is required
2023-07-16 17:45:08.464 +04:00 [INF] Error: prompt=none requested, but consent is required.
2023-07-16 17:45:08.468 +04:00 [INF] {"ClientId":"insig_spa","ClientName":"Insig SPA","RedirectUri":"http://localhost:4200/assets/silent-refresh.html","AllowedRedirectUris":["http://localhost:4200/auth-callback","http://localhost:4200/assets/silent-refresh.html"],"SubjectId":"8a54875e-e7b9-4744-8684-3096f46d8fbd","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email insigapi.read","State":"e0164425bb1242129dd984149bd486ca","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"DD1F26D9566757AB67520C9F4287DA3A","Raw":{"client_id":"insig_spa","redirect_uri":"http://localhost:4200/assets/silent-refresh.html","response_type":"code","scope":"openid profile email insigapi.read","state":"e0164425bb1242129dd984149bd486ca","code_challenge":"VorSClDAzd3lgUgvIi_kQcGKSAziUM-hKY75CgQXXeI","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2023-07-18 18:44:52.917 +04:00 [INF] Removing 0 grants
2023-07-18 18:44:52.948 +04:00 [INF] Removing 0 device flow codes
2023-07-18 19:44:53.138 +04:00 [INF] Removing 0 grants
2023-07-18 19:44:53.146 +04:00 [INF] Removing 0 device flow codes
2023-07-18 20:44:53.304 +04:00 [INF] Removing 0 grants
2023-07-18 20:44:53.319 +04:00 [INF] Removing 0 device flow codes
2023-07-18 21:44:53.424 +04:00 [INF] Removing 0 grants
2023-07-18 21:44:53.435 +04:00 [INF] Removing 0 device flow codes
